<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fi" xml:lang="fi"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Yleisiä toimintoja Excelissä – Kvantitatiiviset menetelmät -kurssin verkkokirja</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../docs/excel/excelgrafiikka.html" rel="next">
<link href="../../docs/excel/nimeäminenexcelissä.html" rel="prev">
<link href="../../pics/logo_lapinakyva.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Ei tuloksia",
    "search-matching-documents-text": "tulokset",
    "search-copy-link-title": "Kopioi linkki hakuun",
    "search-hide-matches-text": "Piilota loput tulokset",
    "search-more-match-text": "tulos tässä dokumentissa",
    "search-more-matches-text": "tulosta tässä dokumentissa",
    "search-clear-button-title": "Tyhjennä",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Peruuta",
    "search-submit-button-title": "Lähetä",
    "search-label": "Hae"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="17&nbsp; Yleisiä toimintoja Excelissä – Kvantitatiiviset menetelmät -kurssin verkkokirja">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Kvantitatiiviset menetelmät</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Hae"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Vaihda navigointi" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Aluksi</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ohjeita" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Ohjeita</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ohjeita">    
        <li>
    <a class="dropdown-item" href="../../docs/ohjeita/visualisoinninalkeet.html">
 <span class="dropdown-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualisoinnin alkeet</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/ohjeita/ohjeitaviittaamiseen.html">
 <span class="dropdown-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Ohjeita viittaamiseen</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/ohjeita/tulostenraportointi.html">
 <span class="dropdown-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tulosten raportointi</span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tilastotiede" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tilastotiede</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tilastotiede">    
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/mittaustasot.html">
 <span class="dropdown-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Muuttuja ja mittaustasot</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/hypoteesitestaus.html">
 <span class="dropdown-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hypoteesitestaus</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/mallioletukset.html">
 <span class="dropdown-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mallioletukset ja virhe</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/sijaintiluvut.html">
 <span class="dropdown-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sijaintiluvut</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/hajontaluvut.html">
 <span class="dropdown-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hajontaluvut</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/merkitsevyysluvut.html">
 <span class="dropdown-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Merkitsevyysluvut</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/eiparametrisettestit.html">
 <span class="dropdown-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Ei-parametriset testit</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/ttesti.html">
 <span class="dropdown-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">T-testi</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/korrelaatio.html">
 <span class="dropdown-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Korrelaatio</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/tilastotiede/khiinneliö.html">
 <span class="dropdown-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Khiin neliö <span class="math inline">\(\chi^2\)</span></span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-excel-toiminnot" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Excel-toiminnot</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-excel-toiminnot">    
        <li>
    <a class="dropdown-item" href="../../docs/excel/excelinperusteet.html">
 <span class="dropdown-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Excelin perusteet</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/excel/excelinkäyttöliittymä.html">
 <span class="dropdown-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Excelin käyttöliittymä</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/excel/nimeäminenexcelissä.html">
 <span class="dropdown-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Nimeäminen Excelissä</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/excel/yleisiätoimintoja.html">
 <span class="dropdown-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Yleisiä toimintoja Excelissä</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/excel/excelgrafiikka.html">
 <span class="dropdown-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Grafiikka Excelissä</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/excel/funktiot.html">
 <span class="dropdown-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Funktiot</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/excel/lambdakaavat.html">
 <span class="dropdown-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">LAMBDA-kaavoja</span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-työkalut" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Työkalut</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-työkalut">    
        <li>
    <a class="dropdown-item" href="../../docs/työkalut/webropol.html">
 <span class="dropdown-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Webropol</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/työkalut/tilastotyökalut.html">
 <span class="dropdown-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Tilastotyökalut</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/työkalut/dmptuuli.html">
 <span class="dropdown-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">DMPTuuli</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/työkalut/tietoarkistot.html">
 <span class="dropdown-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Tietoarkistot</span></span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../docs/työkalut/zotero.html">
 <span class="dropdown-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Zotero-lähdehallintatyökalu</span></span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../viiteluettelo.html"> 
<span class="menu-text">Viiteluettelo</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../history.html"> 
<span class="menu-text">Päivityshistoria</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/osaal/KVANT-23-PEO/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Vaihda sivupalkki" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/excel/yleisiätoimintoja.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Yleisiä toimintoja Excelissä</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Vaihda sivupalkki" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-end sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../pics/logo_nimi_nega.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/excel/excelinperusteet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Excelin perusteet</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/excel/excelinkäyttöliittymä.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Excelin käyttöliittymä</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/excel/nimeäminenexcelissä.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Nimeäminen Excelissä</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/excel/yleisiätoimintoja.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Yleisiä toimintoja Excelissä</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/excel/excelgrafiikka.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Grafiikka Excelissä</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/excel/funktiot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Funktiot</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/excel/lambdakaavat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">LAMBDA-kaavoja</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Sisällysluettelo</h2>
   
  <ul>
  <li><a href="#sec-toiminto01" id="toc-sec-toiminto01" class="nav-link active" data-scroll-target="#sec-toiminto01"><span class="header-section-number">17.1</span> Suodata pois rivit, joissa yhdellä tai useammalla muuttujalla on tyhjiä arvoja</a></li>
  <li><a href="#sec-toiminto02" id="toc-sec-toiminto02" class="nav-link" data-scroll-target="#sec-toiminto02"><span class="header-section-number">17.2</span> Hae kaikkien muuttujien nimet</a></li>
  <li><a href="#sec-toiminto03" id="toc-sec-toiminto03" class="nav-link" data-scroll-target="#sec-toiminto03"><span class="header-section-number">17.3</span> Laske muuttujan ryhmien määrä (k)</a></li>
  <li><a href="#sec-toiminto04" id="toc-sec-toiminto04" class="nav-link" data-scroll-target="#sec-toiminto04"><span class="header-section-number">17.4</span> Hae muuttujan uniikit arvot suuruusjärjestykseen riveihin tai sarakkeisiin</a></li>
  <li><a href="#sec-toiminto05" id="toc-sec-toiminto05" class="nav-link" data-scroll-target="#sec-toiminto05"><span class="header-section-number">17.5</span> Laske N yhdelle muuttujan kategorialle</a></li>
  <li><a href="#sec-toiminto06" id="toc-sec-toiminto06" class="nav-link" data-scroll-target="#sec-toiminto06"><span class="header-section-number">17.6</span> Laske N muuttujan kaikille kategorioille suuruusjärjestyksessä</a></li>
  <li><a href="#sec-toiminto07" id="toc-sec-toiminto07" class="nav-link" data-scroll-target="#sec-toiminto07"><span class="header-section-number">17.7</span> Muuta kaikki virheelliset arvot tyhjiksi soluiksi</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/osaal/KVANT-23-PEO/issues/new" class="toc-action"><i class="bi bi-github"></i>Ilmoita ongelmasta</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-yleisiä-toimintoja-excelissä" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Yleisiä toimintoja Excelissä</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Tästä luvusta löytyy yleisiä toimintoja ja menetelmiä Excelissä. Luettavuuden kannalta olen ympäröinyt jokaisen funktion sulun sisällön välilyönnellä: <code>( tekstiä ( lisää tekstiä ))</code> Tämä ei ole tarpeellista Excelissä omassa työssäsi. Joissain tilanteissä tämä voi myös rikkoa laskukaavan, tarkista aina toimivuus omalla koneellasi.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wordin lainausmerkit eivät toimi Excelissä
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suomenkielisessä Office-paketissa Excel ja Word tuottavat eri lainausmerkit kun kirjoitat lainausmerkin näppäimistöllä. Excelin lainausmerkki näyttää suorilta viivoilta (“). Wordin lainausmerkit taas näyttävät pieniltä pilkuilta (”). Ero on hiuksenhieno, mutta vaikuttaa tuloksiin: Excel ei osaa kääntää Wordin lainausmerkit omakseen, jolloin Wordista kopioidut lainausmerkit eivät toimi Excelin kaavoissa. Lisätietoja lainausmerkkien eroista löydät esimerkiksi tästä <a href="https://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html">Markus Kuhnin kirjoittamasta</a> verkkoartikkelista.</p>
<p>Koska Excelissä voi olla hankalaa kirjoittaa pitkiä kaavoja, voi joskus kuitenkin olla tarpeen kirjoittaa kaavat ensin jossain tekstinkäsittelyohjelmassa ja sitten kopioida ne Exceliin. Suosittelen tähän <strong>Muistio</strong>-ohjelmaa (<em>Notepad</em>), mikä löytyy Windows-käyttöjärjestelmästä valmiina. Jos käytät Mac OS X- tai Linux-käyttöjärjestelmiä, voit käyttää jotain toista raakatekstin käsittelyohjelmaa. Älä kuitenkaan käytä ohjelmia, joissa tekstiä automaattisesti formatoidaan ohjelman puolesta - näissä voi esiintyä samoja ongelmia kuin Excelin ja Wordin välillä.</p>
<p>Toinen suositeltava tapa on laajentaa funktioalue tarpeeksi suureksi, että voit rivittää funktiot ja siten nähdä niiden sisäiset osiot.</p>
</div>
</div>
<section id="sec-toiminto01" class="level2 page-columns page-full" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sec-toiminto01"><span class="header-section-number">17.1</span> Suodata pois rivit, joissa yhdellä tai useammalla muuttujalla on tyhjiä arvoja</h2>
<p>Jos tarvitset poistaa kaikki epätäydelliset rivit jotain analyysia varten, voit käyttää seuraavan tapaista kaavaa:</p>
<p><code>=SUODATA( alue; ( Muuttuja1 &lt;&gt; "" ) * ( Muuttuja2 &lt;&gt; "" ) * ( ... ))</code></p>
<p><u>Jokainen muuttujan rivipoisto määritellään omissa suluissa</u>, muodossa <code>(Muuttuja &lt;&gt; "")</code>. Merkkijono <code>&lt;&gt;</code> on Boolen logiikkaa, ja tarkoittaa samaa kuin “ei ole yhtä kuin” (ks. <a href="excelinperusteet.html#sec-arvojen-manipulointi-excelissä" class="quarto-xref"><span>Alaluku 14.2</span></a>). Merkkijono <code>""</code> esittää tyhjää solua, eli lainausmerkkien välillä ei ole mitään sisältöä. Toisin sanoen, jokainen suodatusehto sanoo “Valitse ne rivit, joiden arvo muuttujalla X ei ole yhtä kuin tyhjä merkki.</p>
<p><u>Voit määritellä niin monta ehtomuuttujaa kuin haluat</u>. Ne lisätään peräkkäin ja kerrotaan yhteen (<code>*</code>). Tämä käytännössä toimii samalla tavalla kuin Boolen logiikan <code>JA</code>-toiminto: kertominen määrittelee, että kaikkien ehtojen tulisi täyttyä jotta rivi otetaan mukaan.</p>
<p><u>Suodatus kannattaa aina tehdä tarpeen mukaan</u>. Jos mahdollista, kannattaa myös käyttää <code>SUODATA</code>-funktiota suoraan seuraavan analyysin funktion sisällä. Monet funktiot eivät nimittäin osaa tulkita <code>SUODATA</code>-funktion tuloksia oikein<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Ongelma liittyy dynaamisiin matriisikaavoihin ja levittyineisiin matriiseihin, jotka voivat olla hankalia ymmärtää. Jos haluat lukea lisää, tietoa löytyy <a href="https://support.microsoft.com/fi-fi/office/dynaamiset-matriisikaavat-ja-levittyneen-matriisin-toiminta-205c6b06-03ba-4151-89a1-87a7eb36e531">Microsoftin apusivuilta</a>.</p></div></div><p><u>Funktio ei osaa käsitellä virhearvoa <code>#TYHJÄ!</code>.</u> Jos syötät alueen, jossa kyseinen virhearvo esiintyy, funktio palauttaa <code>#TYHJÄ!</code>-virheen (engl. <code>#NULL!</code>). Muuta ensin alueen virhearvot joksin muuksi arvoksi (esim. <code>""</code> eli oikeasti tyhjä solu; ks. <a href="#sec-toiminto07" class="quarto-xref"><span>Alaluku 17.7</span></a>), ja suodata sitten tämä tulos.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tärkeää
</div>
</div>
<div class="callout-body-container callout-body">
<p>Jos suodatuksen jälkeen riveillä vielä on tyhjiä soluja jossain (eli ei olla vaadittu täydellistä datamatriisia), <code>SUODATA</code>-funktio täyttää nämä arvolla <code>0</code>. Jos yrität suodattaa tämän tuloksen uudelleen yllä olevalla tavalla, funktio ei enää löydä tyhjiä soluja jotka täyttäisivät ehdot - nolla-arvo ei ole sama asia kuin tyhjä arvo. <u>Peräkkäisiä tyhjien arvojen suodatuksia ei siis oikein voi tehdä</u>, parempi on aina käyttää vain yhtä <code>SUODATA</code>-funktiota kerralla.</p>
</div>
</div>
</section>
<section id="sec-toiminto02" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sec-toiminto02"><span class="header-section-number">17.2</span> Hae kaikkien muuttujien nimet</h2>
<p>Jos haluat kaikki muuttujasi nimet, esimerkiksi sijantilukutaulukkoa varten, voit käyttää seuraavaa kaavaa:</p>
<p><code>=TRANSPONOI( AINUTKERTAISET.ARVOT( VALITSERIVIT( taulukko; 1 )))</code></p>
<p><u>Jotta toiminto toimisi</u>, sinun tulee ensin varmistaa seuraavat asiat:</p>
<ul>
<li><p>Datamatriisin ensimmäisellä rivillä on muuttujien nimet.</p></li>
<li><p>Jos olet määritellyt nimen koko datamatriisille, varmista että määrittely <em>sisältää</em> nimirivin.</p></li>
</ul>
<p>Kaava valitsee ensin ensimmäisen rivin datamatriisista (<code>VALITSERIVIT(taulukko; 1)</code>). Sen jälkeen haetaan kaikki uniikit arvot tältä riviltä (<code>AINUTKERTAISET.ARVOT()</code>). Viimeiseksi tämä rivi transponoidaan sarakemuotoon (<code>TRANSPONOI()</code>), jolloin jokaisen muuttujan nimi tulee omalle riville yhteen sarakkeeseen.</p>
<p><u>Jos haluat pitää muuttujien nimet yhdellä rivillä</u> (eli jakaa ne sarakkeisiin, niin kuin ovat datamatriisissa), jätä pois <code>TRANSPONOI</code>-funktio.</p>
</section>
<section id="sec-toiminto03" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="sec-toiminto03"><span class="header-section-number">17.3</span> Laske muuttujan ryhmien määrä (k)</h2>
<p>Jos haluat laskea, kuinka monta uniikkia ryhmää muuttujassa on, voit käyttää kaavaa:</p>
<p><code>=LASKE.A( AINUTKERTAISET.ARVOT( VALITSESARAKKEET( alue; sarakenumero )))</code></p>
<p>Kaava valitsee ensin sarakkeen funktiolla <code>VALITSESARAKKEET(alue; sarakenumero)</code>. Jos sinulla on valmiiksi nimetty sarake, voit korvata koko tämän osuuden sarakkeen nimellä (katso alla). Seuraavaksi kaava hakee kaikki uniikit arvot sarakkeesta funktiolla <code>AINUTKERTAISET.ARVOT()</code>. Viimeiseksi kaavassa lasketaan, kuinka monta uniikkia arvoa esiintyi funktiolla <code>LASKE.A()</code>.</p>
<p><u>Kaava toimii myös ei-numeroiden määrän laskemisessa</u>, <code>LASKE.A()</code>-funktion avulla. Jos funktion kanssa esiintyy ongelmia, tai jos haluat laskea vain numeroiden määrän, käytä funktion sijaan <code>LASKE()</code>-funktiota.</p>
<p><u>Jos olet jo määritellyt sarakkeen nimen</u>, käytä tätä kaavaa:</p>
<p><code>=LASKE.A(AINUTKERTAISET.ARVOT(sarakenimi))</code></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tärkeää
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>VALITSESARAKKEET</code>-funktio toimii sarakkeen numerolla, ei nimellä tai kirjaimella!</p>
</div>
</div>
</section>
<section id="sec-toiminto04" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="sec-toiminto04"><span class="header-section-number">17.4</span> Hae muuttujan uniikit arvot suuruusjärjestykseen riveihin tai sarakkeisiin</h2>
<p>Jos haluat listata muuttujan kaikki uniikit arvot nousevassa järjestyksessä, voit käyttää kaavoja:</p>
<ul>
<li><p>Riveihin: <code>=LAJITTELE( AINUTKERTAISET.ARVOT( alue ) ; ; 1 )</code></p></li>
<li><p>Sarakkeisiin: <code>=TRANSPONOI( LAJITTELE( AINUTKERTAISET.ARVOT( alue ) ; ; 1 )</code></p></li>
</ul>
<p>Kaava hakee ensin kaikki uniikit arvot määritetyltä alueelta funktiolla <code>AINUTKERTAISET.ARVOT()</code>. Seuraavaksi arvot lajitellaan funktiolla <code>LAJITTELE()</code>. Tässä funktiossa on tärkeää muistaa <strong>kaksi</strong> puolipilkkua. Ensimmäisenä argumenttina syötetään lajiteltava matriisi. Toinen argumentti määrittelee lajitteluindeksin, mutta sitä emme tarvitse tässä, joten jätämme sen tyhjäksi. Kolmas argumentti määrittelee lajittelujärjestyksen, ja se me haluamme määritellä arvoksi <code>1</code>, eli nousevaan järjestykseen.</p>
<p><u>Voit vaihtaa järjestyksen</u> nousevan <code>1</code> ja laskevan <code>-1</code> välillä vapaasti.</p>
</section>
<section id="sec-toiminto05" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="sec-toiminto05"><span class="header-section-number">17.5</span> Laske N yhdelle muuttujan kategorialle</h2>
<p>Jos haluat laskea muuttujan kategorian/ryhmän arvopisteiden määrän, voit käyttää kaavaa:</p>
<p><code>=LASKE.A( SUODATA( muuttuja; muuttuja = arvo ) )</code></p>
<p>Kaava suodattaa ensin muuttuja-alueen arvon mukaan funktiolla <code>SUODATA()</code>, jonka jälkeen se laskee, kuinka monta arvoa suodatetussa muuttujassa on jäljellä funktiolla <code>LASKE.A()</code>.</p>
<p><u>Kaava toimii myös tekstin kanssa</u> <code>LASKE.A()</code>-funktion ansiosta. Valinnaisesti voit laskea vain numeroarvot funktiolla <code>LASKE()</code>.</p>
</section>
<section id="sec-toiminto06" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="sec-toiminto06"><span class="header-section-number">17.6</span> Laske N muuttujan kaikille kategorioille suuruusjärjestyksessä</h2>
<p>Jos haluat laskea <strong>kaikkien</strong> muuttuja-arvojen määrät, voit käyttää seuraavaa kahta kaavaa:</p>
<ul>
<li><p>Ensimmäinen solu: <code>=LAJITTELE( AINUTKERTAISET.ARVOT( muuttuja-alue ) ; ; 1 )</code></p></li>
<li><p>Toinen solu, ensimmäisen solun oikealla puolella: <code>=TAAJUUS( muuttuja-alue; ensimmäinen_solu# )</code></p></li>
</ul>
<p>Ensimmäisessä solussa haetaan kaikki muuttujan uniikit arvot ja lajitellaan ne nousevaan järjestykseen (ks. <a href="#sec-toiminto04" class="quarto-xref"><span>Alaluku 17.4</span></a>).</p>
<p>Toisessa solussa käytetään <code>TAAJUUS</code>-funktiota. Funktion ensimmäinen argumentti on sama muuttuja-alue (nimetty muuttuja, esim. “sukupuoli” tai suora osoite, esim C2:C105) kuin ensimmäisen solun kaavassa.</p>
<p><code>TAAJUUS</code>-funktion toisena argumenttina käytämme ensimmäisen funktion palautusta, mutta huomaa risuaidan <code>#</code> lisääminen soluviittauksen loppuun. Tämä kertoo Excelille, että soluviittaus on levitetty matriisialue, ei yksittäinen solu, jolloin Excel toimittaa funktion jokaiselle matriisissa määritetylle arvolle, ei vain yhdelle. Jos esimerkiksi ensimmäisen solun osoite on <code>C2</code>, kirjoita <code>C2#</code>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tärkeää
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>TAAJUUS</code>-funktio tuottaa aina yhden solun enemmän kuin mitä sille syötettiin: esimerkiksi jos kategorioita on viisi, funktio palauttaa kuusi solua. Viimeinen solu sisältää määrän kaikista arvoista, jotka ylittävät suurimman määritetyn arvon. Kvalitatiiviselle muuttujalle (jossa kategoriat ovat määriteltyjä) tämä arvo on aina <code>0</code>.</p>
<p>Tämä tuki löytyy, koska <code>TAAJUUS</code>-funktiota voi myös käyttää rakentaakseen kategorioita kvantitatiivisesta muuttujasta, jolloin kategoriat eivät välttämättä kata koko jakauman pituutta.</p>
<p>Jos raportoit kategorisen muuttujan määriä, jätä pois viimeinen <code>0</code>-solu, koska sitä ei ole mahdollista saada arvoksi.</p>
</div>
</div>
</section>
<section id="sec-toiminto07" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="sec-toiminto07"><span class="header-section-number">17.7</span> Muuta kaikki virheelliset arvot tyhjiksi soluiksi</h2>
<p>Jos sinulla on virhearvoja data-alueellasi (esim. <code>#TYHJÄ!</code>, <code>#JAKO/0!</code>), useimmat kaavat eivät toimi alueen kanssa. Silloin sinun kannattaa tehdä uusi muuttuja data-alueellesi, jonka soluihin syötät seuraavan kaavan:</p>
<p><code>=JOS( ONLUKU (solu) ; solu ; "" )</code></p>
<p>Kaava tarkistaa, onko tarkistettu solu luku (muuta tämä <code>ONTEKSTI</code>-funktioksi, jos suodatat tekstiä). Jos se on luku, kaava palauttaa alkuperäisen solun arvon. Jos ei ole luku (esim. virhearvo), kaava palauttaa tyhjän solun <code>""</code>. Voit myös määritellä toisen palautusarvon, jos et halua käyttää tyhjää solua (esim. <code>999</code>).</p>
<p><u>Lisää kaava ensimmäiseen soluun</u> ja levitä se kaikkien rivien yli vetotoiminnolla.</p>
<p>Voit halutessasi vaihtaa palautettavan arvon, jos Excel ei löydä lukua. Useimmiten kuitenkin tyhjä solu on helposti käsiteltävissä (esim. <code>ONTYHJÄ</code>-funktiolla), joten sen käyttö voi olla suositeltavaa, etteivät arvot mene sekaisin analyysissa.</p>
<p>Toiminnon voi myös automatisoida koko datajärjestykselle käyttämällä <code>BYROW</code>-funktiota ja LAMBDA-rakennetta. Kaava näyttää seuraavalta:</p>
<p><code>=BYROW( muuttuja; LAMBDA( x; JOS( ONLUKU( x ); x; "" ) ) )</code></p>
<p><code>BYROW</code>-funktio suorittaa määritetyn LAMBDA-funktion tietyn alueen jokaiselle riville - tämä vastaa manuaalista kaavan lisäämistä jokaiselle riville. <code>LAMBDA</code>-funktiossa määritetään sisääntulevan datan nimi (<code>x</code>). Sen lisäksi määritetään, mitä sille tulisi tehdä, eli aikaisempi <code>JOS</code>-rakenne.</p>
<p><code>BYROW</code>-rakenne palauttaa yhtä monta riviä kuin alkuperäisessä on. Tämä tarkoittaa myös tyhjiä rivejä niille riveille, jotka eivät täytä <code>JOS</code>-funktion vaatimuksia.</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopioitu!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopioitu!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../docs/excel/nimeäminenexcelissä.html" class="pagination-link" aria-label="Nimeäminen Excelissä">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Nimeäminen Excelissä</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../docs/excel/excelgrafiikka.html" class="pagination-link" aria-label="Grafiikka Excelissä">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Grafiikka Excelissä</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Tekijänoikeudet (c) 2023, Oliver Saal</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/osaal/KVANT-23-PEO/issues/new" class="toc-action"><i class="bi bi-github"></i>Ilmoita ongelmasta</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>