<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fi" xml:lang="fi"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Kvantitatiiviset menetelmät, syksy 2023 - 4&nbsp; Funktiot</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./sijaintiluvut.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Ei tuloksia",
    "search-matching-documents-text": "tulokset",
    "search-copy-link-title": "Kopioi linkki hakuun",
    "search-hide-matches-text": "Piilota loput tulokset",
    "search-more-match-text": "tulos tässä dokumentissa",
    "search-more-matches-text": "tulosta tässä dokumentissa",
    "search-clear-button-title": "Tyhjennä",
    "search-detached-cancel-button-title": "Peruuta",
    "search-submit-button-title": "Lähetä"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Vaihda sivupalkki" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./perustoiminnot.html">Excel-toiminnot</a></li><li class="breadcrumb-item"><a href="./perustoiminnot.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktiot</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Vaihda sivupalkki" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Hae" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Kvantitatiiviset menetelmät, syksy 2023</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Hae"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aluksi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Tilastotiede</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Vaihda osio">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sijaintiluvut.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sijaintiluvut</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Excel-toiminnot</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Vaihda osio">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./perustoiminnot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktiot</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Viiteluettelo</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sisällysluettelo</h2>
   
  <ul>
  <li><a href="#tietofunktiot" id="toc-tietofunktiot" class="nav-link active" data-scroll-target="#tietofunktiot"><span class="header-section-number">4.1</span> Tietofunktiot</a>
  <ul class="collapse">
  <li><a href="#on-toiminnot" id="toc-on-toiminnot" class="nav-link" data-scroll-target="#on-toiminnot"><span class="header-section-number">4.1.1</span> ON-toiminnot</a></li>
  <li><a href="#puuttuu" id="toc-puuttuu" class="nav-link" data-scroll-target="#puuttuu"><span class="header-section-number">4.1.2</span> PUUTTUU</a></li>
  <li><a href="#solu" id="toc-solu" class="nav-link" data-scroll-target="#solu"><span class="header-section-number">4.1.3</span> SOLU</a></li>
  </ul></li>
  <li><a href="#loogiset-funktiot" id="toc-loogiset-funktiot" class="nav-link" data-scroll-target="#loogiset-funktiot"><span class="header-section-number">4.2</span> Loogiset funktiot</a>
  <ul class="collapse">
  <li><a href="#tosi-ja-epätosi" id="toc-tosi-ja-epätosi" class="nav-link" data-scroll-target="#tosi-ja-epätosi"><span class="header-section-number">4.2.1</span> TOSI ja EPÄTOSI</a></li>
  <li><a href="#ja" id="toc-ja" class="nav-link" data-scroll-target="#ja"><span class="header-section-number">4.2.2</span> JA</a></li>
  <li><a href="#jos-funktiot" id="toc-jos-funktiot" class="nav-link" data-scroll-target="#jos-funktiot"><span class="header-section-number">4.2.3</span> JOS-funktiot</a></li>
  <li><a href="#ei" id="toc-ei" class="nav-link" data-scroll-target="#ei"><span class="header-section-number">4.2.4</span> EI</a></li>
  <li><a href="#tai-ja-ehdoton.tai" id="toc-tai-ja-ehdoton.tai" class="nav-link" data-scroll-target="#tai-ja-ehdoton.tai"><span class="header-section-number">4.2.5</span> TAI ja EHDOTON.TAI</a></li>
  <li><a href="#lambda" id="toc-lambda" class="nav-link" data-scroll-target="#lambda"><span class="header-section-number">4.2.6</span> LAMBDA</a></li>
  <li><a href="#bycol-byrow-ja-map" id="toc-bycol-byrow-ja-map" class="nav-link" data-scroll-target="#bycol-byrow-ja-map"><span class="header-section-number">4.2.7</span> BYCOL, BYROW ja MAP</a></li>
  </ul></li>
  <li><a href="#haku--ja-viitefunktiot" id="toc-haku--ja-viitefunktiot" class="nav-link" data-scroll-target="#haku--ja-viitefunktiot"><span class="header-section-number">4.3</span> Haku- ja viitefunktiot</a>
  <ul class="collapse">
  <li><a href="#valitse-funktiot" id="toc-valitse-funktiot" class="nav-link" data-scroll-target="#valitse-funktiot"><span class="header-section-number">4.3.1</span> VALITSE-funktiot</a></li>
  <li><a href="#sarake-ja-rivi" id="toc-sarake-ja-rivi" class="nav-link" data-scroll-target="#sarake-ja-rivi"><span class="header-section-number">4.3.2</span> SARAKE ja RIVI</a></li>
  <li><a href="#hylkää" id="toc-hylkää" class="nav-link" data-scroll-target="#hylkää"><span class="header-section-number">4.3.3</span> HYLKÄÄ</a></li>
  <li><a href="#suodata" id="toc-suodata" class="nav-link" data-scroll-target="#suodata"><span class="header-section-number">4.3.4</span> SUODATA</a></li>
  <li><a href="#xhaku" id="toc-xhaku" class="nav-link" data-scroll-target="#xhaku"><span class="header-section-number">4.3.5</span> XHAKU</a></li>
  <li><a href="#lajittelufunktiot" id="toc-lajittelufunktiot" class="nav-link" data-scroll-target="#lajittelufunktiot"><span class="header-section-number">4.3.6</span> Lajittelufunktiot</a></li>
  <li><a href="#ota" id="toc-ota" class="nav-link" data-scroll-target="#ota"><span class="header-section-number">4.3.7</span> OTA</a></li>
  <li><a href="#transponoi" id="toc-transponoi" class="nav-link" data-scroll-target="#transponoi"><span class="header-section-number">4.3.8</span> TRANSPONOI</a></li>
  <li><a href="#ainutkertaiset.arvot" id="toc-ainutkertaiset.arvot" class="nav-link" data-scroll-target="#ainutkertaiset.arvot"><span class="header-section-number">4.3.9</span> AINUTKERTAISET.ARVOT</a></li>
  </ul></li>
  <li><a href="#matemaattiset-ja-trigonometriset-funktiot" id="toc-matemaattiset-ja-trigonometriset-funktiot" class="nav-link" data-scroll-target="#matemaattiset-ja-trigonometriset-funktiot"><span class="header-section-number">4.4</span> Matemaattiset ja trigonometriset funktiot</a>
  <ul class="collapse">
  <li><a href="#trigonometriset-funktiot" id="toc-trigonometriset-funktiot" class="nav-link" data-scroll-target="#trigonometriset-funktiot"><span class="header-section-number">4.4.1</span> Trigonometriset funktiot</a></li>
  <li><a href="#itseisarvo" id="toc-itseisarvo" class="nav-link" data-scroll-target="#itseisarvo"><span class="header-section-number">4.4.2</span> ITSEISARVO</a></li>
  <li><a href="#kooste-ja-välisumma" id="toc-kooste-ja-välisumma" class="nav-link" data-scroll-target="#kooste-ja-välisumma"><span class="header-section-number">4.4.3</span> KOOSTE ja VÄLISUMMA</a></li>
  <li><a href="#parillinen-ja-pariton" id="toc-parillinen-ja-pariton" class="nav-link" data-scroll-target="#parillinen-ja-pariton"><span class="header-section-number">4.4.4</span> PARILLINEN ja PARITON</a></li>
  <li><a href="#eksponentti" id="toc-eksponentti" class="nav-link" data-scroll-target="#eksponentti"><span class="header-section-number">4.4.5</span> EKSPONENTTI</a></li>
  <li><a href="#kertoma" id="toc-kertoma" class="nav-link" data-scroll-target="#kertoma"><span class="header-section-number">4.4.6</span> KERTOMA</a></li>
  <li><a href="#pyöristysfunktiot" id="toc-pyöristysfunktiot" class="nav-link" data-scroll-target="#pyöristysfunktiot"><span class="header-section-number">4.4.7</span> Pyöristysfunktiot</a></li>
  <li><a href="#suurin.yht.tekijä-ja-pienin.yht.jaettava" id="toc-suurin.yht.tekijä-ja-pienin.yht.jaettava" class="nav-link" data-scroll-target="#suurin.yht.tekijä-ja-pienin.yht.jaettava"><span class="header-section-number">4.4.8</span> SUURIN.YHT.TEKIJÄ ja PIENIN.YHT.JAETTAVA</a></li>
  <li><a href="#logaritmit" id="toc-logaritmit" class="nav-link" data-scroll-target="#logaritmit"><span class="header-section-number">4.4.9</span> Logaritmit</a></li>
  <li><a href="#jakoj" id="toc-jakoj" class="nav-link" data-scroll-target="#jakoj"><span class="header-section-number">4.4.10</span> JAKOJ</a></li>
  <li><a href="#pii" id="toc-pii" class="nav-link" data-scroll-target="#pii"><span class="header-section-number">4.4.11</span> PII</a></li>
  <li><a href="#satunnaisluvut" id="toc-satunnaisluvut" class="nav-link" data-scroll-target="#satunnaisluvut"><span class="header-section-number">4.4.12</span> Satunnaisluvut</a></li>
  <li><a href="#neliöjuuret" id="toc-neliöjuuret" class="nav-link" data-scroll-target="#neliöjuuret"><span class="header-section-number">4.4.13</span> Neliöjuuret</a></li>
  <li><a href="#summat" id="toc-summat" class="nav-link" data-scroll-target="#summat"><span class="header-section-number">4.4.14</span> Summat</a></li>
  <li><a href="#neliösummat" id="toc-neliösummat" class="nav-link" data-scroll-target="#neliösummat"><span class="header-section-number">4.4.15</span> Neliösummat</a></li>
  <li><a href="#katkaise" id="toc-katkaise" class="nav-link" data-scroll-target="#katkaise"><span class="header-section-number">4.4.16</span> KATKAISE</a></li>
  </ul></li>
  <li><a href="#tilastolliset-funktiot" id="toc-tilastolliset-funktiot" class="nav-link" data-scroll-target="#tilastolliset-funktiot"><span class="header-section-number">4.5</span> Tilastolliset funktiot</a>
  <ul class="collapse">
  <li><a href="#sijaintiluvut" id="toc-sijaintiluvut" class="nav-link" data-scroll-target="#sijaintiluvut"><span class="header-section-number">4.5.1</span> Sijaintiluvut</a></li>
  <li><a href="#hajontaluvut" id="toc-hajontaluvut" class="nav-link" data-scroll-target="#hajontaluvut"><span class="header-section-number">4.5.2</span> Hajontaluvut</a></li>
  <li><a href="#univariaatit-testit" id="toc-univariaatit-testit" class="nav-link" data-scroll-target="#univariaatit-testit"><span class="header-section-number">4.5.3</span> Univariaatit testit</a></li>
  <li><a href="#bivariaatit-testit" id="toc-bivariaatit-testit" class="nav-link" data-scroll-target="#bivariaatit-testit"><span class="header-section-number">4.5.4</span> Bivariaatit testit</a></li>
  </ul></li>
  <li><a href="#tekstifunktiot" id="toc-tekstifunktiot" class="nav-link" data-scroll-target="#tekstifunktiot"><span class="header-section-number">4.6</span> Tekstifunktiot</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktiot</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-note callout-titled" title="Lähde">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lähde
</div>
</div>
<div class="callout-body-container callout-body">
<p>Funktioiden määritelmät ja käyttökuvaukset ovat haettu Excelin dokumentaatiosta. Dokumentaatiosta löytyy enemmän funktioita; kuvailen tässä ne, jotka voivat olla eniten hyödyllisiä työssäsi. Löydät kaikki Excelin funktiot ryhmitettynä luokkiin täältä: <a href="https://support.microsoft.com/fi-fi/office/excelin-funktiot-luokittain-5f91f4e9-7b42-46d2-9bd1-63f26a86c0eb">Excelin funktiot (luokittain)</a></p>
</div>
</div>
<section id="tietofunktiot" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="tietofunktiot"><span class="header-section-number">4.1</span> Tietofunktiot</h2>
<section id="on-toiminnot" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="on-toiminnot"><span class="header-section-number">4.1.1</span> ON-toiminnot</h3>
<p><code>=FUNKTIO(soluarvo)</code></p>
<p>ON-toiminnot palauttavat totuusarvon <code>TOSI</code>, jos niiden vaatimus solulle täyttyy. Jos vaatimus ei täyty, toiminnot palauttavat totuusarvon <code>EPÄTOSI</code>.</p>
<p>Soluarvo voi olla arvo itsessään tai viittaus toiseen soluun.</p>
<p>Toiminnot ja niiden vaatimukset:</p>
<ul>
<li>ONTYHJÄ: Onko soluarvo tyhjä?</li>
<li>ONVIRH: Onko soluarvo jotain muuta, kuin <code>#PUUTTUU!</code>? (Eli ONPUUTTUU-toiminnon vastakohta)</li>
<li>ONVIRHE: Onko soluarvo jokin virhearvo? (<code>#PUUTTUU!, #ARVO!, #VIITTAUS!, #JAKO/0!, #LUKU!, #NIMI?, #TYHJÄ!</code>)</li>
<li>ONTOTUUS: Onko soluarvo totuusarvo? (<code>TOSI</code> tai <code>EPÄTOSI</code>)</li>
<li>ONPUUTTUU: Onko soluarvo virhearvo <code>#PUUTTUU!</code>? (Eli ONVIRH-toiminnon vastakohta)</li>
<li>ONEI_TEKSTI: Onko soluarvo jotain muuta kun tekstiä? Palauttaa TOSI, jos soluarvo on tyhjä solu.</li>
<li>ONLUKU: Onko soluarvo luku?</li>
<li>ONVIITT: Onko soluarvo viittaus toiseen paikkaan?</li>
<li>ONTEKSTI: Onko soluarvo tekstiä?</li>
<li>ONPARILLINEN: Onko soluarvo parillinen? (Eli ONPARITON-toiminnon vastakohta)</li>
<li>ONPARITON: Onko soluarvo pariton? (Eli ONPARILLINEN-toiminnon vastakohta)</li>
<li>ONKAAVA: Onko soluarvo kaava?</li>
</ul>
</section>
<section id="puuttuu" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="puuttuu"><span class="header-section-number">4.1.2</span> PUUTTUU</h3>
<p><code>=PUUTTUU()</code></p>
<p>Palauttaa virhearvon <code>#PUUTTUU!</code>.</p>
</section>
<section id="solu" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="solu"><span class="header-section-number">4.1.3</span> SOLU</h3>
<p><code>=SOLU(kuvaus_laji; viittaus)</code></p>
<p>Palauttaa tietoa soluviittauksesta.</p>
<p>Viittausalue määritellään <code>viittaus</code>-kohdassa. Tietopyyntö määritellään <code>kuvaus_laji</code>-kohdassa.</p>
<p>Tietopyyntöjen eri määritelmät:</p>
<table class="table">
<caption>SOLU-funktion <code>kuvaus_laji</code>-avainsanat</caption>
<thead>
<tr class="header">
<th>Avainsana</th>
<th>Palautus</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“osoite”</td>
<td>Soluviittauksen osoite tekstinä (esim. A2)</td>
</tr>
<tr class="even">
<td>“sarake”</td>
<td>Solun sarake numerona (esim. 2 sarakkeelle B)</td>
</tr>
<tr class="odd">
<td>“väri”</td>
<td>Arvo 1, jos solun negatiiviset arvot näkyvät värillisinä. Muuten arvo 0.</td>
</tr>
<tr class="even">
<td>“sisältö”</td>
<td>Solun arvon (esim. 1000 tai “Hei”)</td>
</tr>
<tr class="odd">
<td>“tiedostonimi”</td>
<td>Solun sisältävän tiedoston nimen. Palauttaa tyhjää “” jos tiedostoa ei ole tallennettu.</td>
</tr>
<tr class="even">
<td>“muoto”</td>
<td>Solun lukumuotoilun erityisenä merkkijonona. Katso kaikki merkkijonot <a href="https://support.microsoft.com/fi-fi/office/solu-solu-funktio-51bd39a5-f338-4dbe-a33f-955d67c2b2cf">funktion apusivuilta</a></td>
</tr>
<tr class="odd">
<td>“sulkeet”</td>
<td>Arvo 1, jos solun positiiviset/kaikki arvot esitetään sulkeissa. Muuten arvo 0.</td>
</tr>
<tr class="even">
<td>“etuliite”</td>
<td>Solun tasausmuotoilun erityisenä merkkijonona. Katso kaikki merkkijonot <a href="https://support.microsoft.com/fi-fi/office/solu-solu-funktio-51bd39a5-f338-4dbe-a33f-955d67c2b2cf">funktion apusivuilta</a></td>
</tr>
<tr class="odd">
<td>“suojaus”</td>
<td>Arvo 1, jos solu on lukittu, tai arvo 0, jos solua ei ole lukittu.</td>
</tr>
<tr class="even">
<td>“rivi”</td>
<td>Solun rivi numerona (esim. 2 riville 2)</td>
</tr>
<tr class="odd">
<td>“tyyppi”</td>
<td>Solun sisällön tyyppi erityisenä merkkijonona. Palauttaa “h” jos solu on tyhjä, “o” jos solussa on tekstivakio, ja muuten “r”.</td>
</tr>
<tr class="even">
<td>“leveys”</td>
<td>Palauttaa kaksikohteisen matriisin. Ensimmäisessä kohteessa on solun sarakeleveys. Toisessa kohteessa on totuusarvo TOSI, jos kyseinen leveys on oletusarvo, ja EPÄTOSI jos leveyttä on muutettu käyttäjän toimesta.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="loogiset-funktiot" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="loogiset-funktiot"><span class="header-section-number">4.2</span> Loogiset funktiot</h2>
<section id="tosi-ja-epätosi" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="tosi-ja-epätosi"><span class="header-section-number">4.2.1</span> TOSI ja EPÄTOSI</h3>
<p><code>=TOSI()</code>, <code>=EPÄTOSI()</code></p>
<p>Palauttavat totuusarvot TOSI tai EPÄTOSI, nimensä mukaan. Voit vaihtoehtoisesti käyttää sanoja TOSI tai EPÄTOSI funktioiden sijaan.</p>
</section>
<section id="ja" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="ja"><span class="header-section-number">4.2.2</span> JA</h3>
<p><code>=JA(arg1; arg2; ...)</code></p>
<p>Palauttaa totuusarvon TOSI, jos kaikki funktion argumenttien arvot ovat TOSI. Palauttaa EPÄTOSI, jos vähintään yksi funktion argumenteista on EPÄTOSI.</p>
<p>TAI-funktion vastakohta.</p>
<p>Argumenttien tulee olla totuusarvoja tai solu- tai matriisiviittauksia totuusarvoihin.</p>
<p>Funktio ei ota huomioon tekstiä, lukuja tai tyhjiä soluja.</p>
<p>Käytetään usein yhdistelmässä muiden loogisten funktioiden kanssa.</p>
</section>
<section id="jos-funktiot" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="jos-funktiot"><span class="header-section-number">4.2.3</span> JOS-funktiot</h3>
<p><code>=JOS(arvioitava; jostosi; josepätosi)</code></p>
<p>Arvioi loogisen funktion argumentissa <code>arvioitava</code>. Käyttäjä määrittelee mitä palautetaan, jos <code>arvioitava</code>-funktion tulos on tosi (argumentti <code>jostosi</code>), sekä jos tulos on epätosi (argumentti <code>josepätosi</code>).</p>
<p><code>=JOSVIRHE(arvioitava; josvirhe)</code></p>
<p>Arvioi loogisen funktion argumentissa <code>arvioitava</code>. Käyttäjä määrittelee mitä palautetaan, jos funktion tulos palauttaa virhearvon (argumentti <code>josvirhe</code>).</p>
<p><code>=JOSPUUTTUU(arvioitava; jospuuttuu)</code></p>
<p>Arvioi loogisen funktion argumentissa <code>arvioitava</code>. Käyttäjä määrittelee mitä palautetaan, jos funktion tulos palauttaa virhearvon <code>#PUUTTUU!</code> (argumentti <code>jospuuttuu</code>).</p>
<p><code>=JOS.JOUKKO(arvioitava1; jostosi1; arvioitava2; jostosi2; ...)</code></p>
<p>Arvioi yhden tai useamman (korkeintaan 127) loogisen funktion ja palauttaa sitä vastaavan totuusfunktion <code>jostosiN</code>, jos <code>arvioitavaN</code>-funktion tulos on tosi.</p>
<p>Jokaiselle arvioitavalle funktiolle tulee syöttää yksi TOSI-ehdon alla tuotettava arvo, eli argumentit syötetään pareissa. Yksi ehto arvioidaan kahdella argumentilla (<code>arvioitava1</code>, <code>jostosi1</code>); kaksi ehtoa arvioidaan neljällä argumentilla (<code>arvioitava1</code>, <code>jostosi1</code>, <code>arvioitava2</code>, <code>jostosi2</code>); ja niin edelleen.</p>
</section>
<section id="ei" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="ei"><span class="header-section-number">4.2.4</span> EI</h3>
<p><code>=EI(arvioitava)</code></p>
<p>Palauttaa argumentin <code>arvioitava</code> totuustuloksen vastakohdan, eli EPÄTOSI jos argumentin tulos on TOSI tai toisinpäin.</p>
</section>
<section id="tai-ja-ehdoton.tai" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="tai-ja-ehdoton.tai"><span class="header-section-number">4.2.5</span> TAI ja EHDOTON.TAI</h3>
<p><code>=TAI(arg1; arg2; ...)</code></p>
<p>Palauttaa totuusarvon TOSI, jos vähintään yksi funktion argumenteista ovat TOSI. Palauttaa EPÄTOSI, jos kaikki funktion argumenttien totuusarvot on EPÄTOSI.</p>
<p>JA-funktion vastakohta.</p>
<p>Argumenttien tulee olla totuusarvoja tai solu- tai matriisiviittauksia totuusarvoihin.</p>
<p>Funktio ei ota huomioon tekstiä, lukuja tai tyhjiä soluja.</p>
<p>Käytetään usein yhdistelmässä muiden loogisten funktioiden kanssa.</p>
<p><code>=EHDOTON.TAI(arg1; arg2; ...)</code></p>
<p>Palauttaa totuusarvon TOSI, jos vähintään yksi <em>mutta ei kaikki</em> funktion argumenteista ovat TOSI. Palauttaa EPÄTOSI, jos kaikki funktion argumenttien totuusarvot ovat joko TOSI tai EPÄTOSI.</p>
<p>Ehdoton versio TAI-funktiosta. Toimii samalla tavalla.</p>
</section>
<section id="lambda" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="lambda"><span class="header-section-number">4.2.6</span> LAMBDA</h3>
<p><code>=LAMBDA(par1; par2; ...; parN; laskutoimitus)</code></p>
<p>LAMBDA-toiminnolla voit laatia omia funktioitasi. Voit määritellä enintään 253 parametria (vähintään nolla) joita funktioisi käyttää. Voit sitten määritellä mitä funktiosi tekee argumentilla <code>laskutoimitus</code>.</p>
<p>Toimivan LAMBDA-funktion toteuttamisen jälkeen voit rekisteröidä funktion nimen <strong>Nimien hallinta</strong> -tilassa, jolloin funktiota pystyy käyttämään koko työkirjassa (tai työlehtiössä, jos olet rajannut käytön. Ks. LUKU NIMIEN HALLINNASTA).</p>
<p>LAMBDA-toiminto kannattaa tehdä kolmessa askeleessa:</p>
<ol type="1">
<li>Testaa, että <code>laskutoimitus</code>-kaavasi toimii. Muista luoda sille tapoja reagoida virheisiin (käytä tietofunktioita!)</li>
<li>Testaa, että koko LAMBDA-funktio toimii. Kirjoita se kokonaisuudessaan soluun, ja lisää loppuun testiarvot omaan sulkuun: <code>=LAMBDA(x; y; x+y+1)(1;2)</code> määrittelee funktion ja ajaa sen testiarvoilla x = 1 ja y = 2.</li>
<li>Lisää funktio <strong>Nimien hallinta</strong>-tilaan. Muista määritellä oikea käyttöalue (työkirja tai yksittäiset taulukot) sekä antaa kuvaileva nimi ja kommentti. Katso lisää nimien hallinnasta luvusta LUKU NIMIEN HALLINNASTA).</li>
</ol>
</section>
<section id="bycol-byrow-ja-map" class="level3" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="bycol-byrow-ja-map"><span class="header-section-number">4.2.7</span> BYCOL, BYROW ja MAP</h3>
<p><code>=BYCOL(matriisi; LAMBDA(sarake))</code>, <code>=BYROW(matriisi; LAMBDA(rivi))</code>, <code>=MAP(matriisi; LAMBDA(solu)</code></p>
<p>Funktioilla voit suorittaa LAMBDA-funktion määritetyn matriisialueen jokaiselle riville (<code>BYROW</code>), sarakkeelle (<code>BYCOL</code>) tai yksittäiselle solulle (<code>MAP</code>).</p>
<p>Argumentilla <code>matriisi</code> määrittelet data-alueen, jonka datalla haluat toimittaa LAMBDA-funktion.</p>
<p>Argumentilla <code>LAMBDA()</code> määrittelet LAMBDA-funktion, mikä tulee ajaa haluamasi data-alueella.</p>
<p>Määrittele LAMBDA-funktio niin kuin tekisit oman funktion, mutta älä rekisteröi sen nimeä - funktiota käytetään vain tässä kontekstissa.</p>
<p>Funktiopari <code>BYCOL</code> ja <code>BYROW</code> palauttaa matriisiin kooltaan 1*N, jossa N on kuinka monta kertaa funktio ajettiin. Funktio <code>MAP</code> taas palauttaa matriisin, jonka koko vastaa alkuperäistä data-aluetta (koska funktion LAMBDA-funktio lasketaan jokaiselle solulle).</p>
<p>Jos määritelty data-alue sisältäisi neljä saraketta, <code>BYCOL</code> palauttaisi 1*4-matriisin. Jos määritelty data-alue taas sisältäisi kolme riviä, <code>BYROW</code> palauttaisi 1*3-matriisin. Jos määritelty data-alue sisältää neljä saraketta ja kolme riviä, <code>MAP</code> palauttaisi 4*3-matriisin.</p>
<p><code>MAP</code>-funktio osaa myös yhdistää monia solujonoja yhteen. Tällöin funktio palauttaa 1*N-matriisin, jossa N on yhdistettävien solujonojen määrä. Esimerkiksi <code>=MAP(A1:A5; B1:B5; C1:C5; LAMBDA()</code> palauttaa 1*3-matriisin, jossa jokainen solu on LAMBDA-funktion lopputulos kullekin solujonolle (ensin A1:A5, sitten B1:B5, ja viimeiseksi C1:C5).</p>
<p>Ole tarkkana kun syötät <code>MAP</code>-funktiolle dataa! Jos yhdistät solujonoja, funktiot ajetaan <em>per solujono</em>, mutta jos syötät kokonaisen matriisin, funktiot ajetaan <em>per solu</em>.</p>
<p>Esimerkki:</p>
<p><code>=BYCOL(A1:C2; LAMBDA(sarake; MAKS(sarake))</code> palauttaa 1*3-matriisin (koska data-alueella on kolme saraketta, A, B ja C). Jokaisessa solussa on LAMBDA-funktion lopputulos sille sarakkeelle (ensimmäisessä solussa tulos A-sarakkeelle, toisessa B-sarakkeelle ja kolmannessa C-sarakkeelle). Laskettava funktio on <code>MAKS(sarake)</code>, mikä palauttaa sarakkeen suurimman arvon.</p>
</section>
</section>
<section id="haku--ja-viitefunktiot" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="haku--ja-viitefunktiot"><span class="header-section-number">4.3</span> Haku- ja viitefunktiot</h2>
<section id="valitse-funktiot" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="valitse-funktiot"><span class="header-section-number">4.3.1</span> VALITSE-funktiot</h3>
<p><code>=VALITSESARAKKEET(matriisi; sarake1; ...)</code>, <code>=VALITSERIVIT(matriisi; rivi1; ...)</code></p>
<p>Funktio palauttaa valitut sarakkeet tai rivit <code>matriisi</code>-alueelta. Funktiolle annetaan sarake- tai rivinumero (ei siis kirjainta sarakkeiden kohdalla!), sekä alue, josta haetaan. Funktioille voi antaa useamman sarake- tai rivinumeron.</p>
<p>Negatiivisilla rivi- tai sarakenumeroilla voi hakea tietoja matriisin lopusta. Arvo <code>-1</code> on sama kuin viimeinen sarake/rivi, <code>-2</code> toiseksi viimeinen, ja niin eteenpäin. Näin funktio voi toimia, vaikka et tietäisi, kuinka monta riviä/saraketta alkuperäisessä matriisissa olisi.</p>
<p>Rivi- tai sarakenumerot eivät tarvitse olla alkuperäisessä järjestyksessään, vaan ne palautetaan siinä järjestyksessä, miten ne määritellään funktiossa. Esimerkiksi sarakenumerot <code>1, 2, 5, 4</code> palauttaa vastaavat sarakkeet (<code>A, B, E, D</code>) tässä järjestyksessä.</p>
<p>Esimerkki:</p>
<p><code>=VALITSESARAKKEET(A1:C5; 2)</code> palauttaa sarakkeen B (sarakenumero 2) kaikki arvot. Koska alueella on viisi riviä, funktio palauttaa seuraavat solut: <code>B1, B2, B3, B4, B5</code>.</p>
<p><code>=VALITSERIVIT(A1:C5, 2, 4)</code> palauttaa rivien 2 ja 4 kaikki arvot. Koska alueella on kolme saraketta ja valittiin kaksi riviä palautukseen, funktio palauttaa matriisin jossa ensimmäisellä rivillä on solut <code>A2, B2, C2</code> ja toisella rivillä solut <code>A4, B4, C4</code>.</p>
</section>
<section id="sarake-ja-rivi" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="sarake-ja-rivi"><span class="header-section-number">4.3.2</span> SARAKE ja RIVI</h3>
<p><code>=SARAKE(solu)</code>, <code>=RIVI(solu)</code></p>
<p>Funktiot palauttavat solun sarake- tai rivinumeron. Numerointi on juoksevassa järjestyksessä: riveillä numero on sama kuin rivin viittausnumero yleisesti (1 on 1, 2 on 2, jne.), ja sarakkeille numerointi alkaa yhdestä (A on 1, B on 2, jne.).</p>
</section>
<section id="hylkää" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="hylkää"><span class="header-section-number">4.3.3</span> HYLKÄÄ</h3>
<p><code>=HYLKÄÄ(matriisi; rivit; sarakkeet)</code></p>
<p>Funktio poistaa määritetyn määrän rivejä ja/tai sarakkeita alkuperäisestä matriisista, ja palauttaa tämän uuden matriisin. Poisto koskee vain palautettua matriisia - funktio ei siis poista tietoja alkuperäisestä matriisista. <code>rivit</code> on pakollinen, <code>sarakkeet</code> on valinnainen.</p>
<p>Negatiivisilla arvoilla voit poista rivejä/sarakkeita matriisin lopusta alkupään sijaan: <code>rivit = -1</code> poistaa viimeisen rivin, <code>sarakkeet = -3</code> poistaa kolme viimeistä saraketta, ja niin eteenpäin.</p>
</section>
<section id="suodata" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="suodata"><span class="header-section-number">4.3.4</span> SUODATA</h3>
<p><code>=SUODATA(matriisi; sisällytä; jostyhjä)</code></p>
<p>Funktio palauttaa suodatetun version alkuperäisestä matriisista. Avainsanalla <code>sisällytä</code> määrittelet hakualueen, jonka pohjalta suodatetaan, sekä loogisen säännön millä sisällytetään rivejä. Avainsanalla <code>jostyhjä</code> määrittelet mitä palautetaan, jos palautettava matriisi on tyhjä (eli suodatin ei löytänyt yhtään sääntöä vastaavaa tulosta).</p>
<p>Esimerkki:</p>
<p><code>=SUODATA(A1:C5; B1:B5 = 2)</code> hakee matriisin <code>A1:C5</code> (kolme saraketta, viisi riviä), ja palauttaa kaikki rivit, joiden B-sarakkeen arvo on 2. Jos näitä ei ole, funktio palauttaa virhearvon <code>#TYHJÄ!</code>.</p>
<p><code>=SUODATA(A1:C5; var1 = E1; "Ei löydy!")</code> hakee matriisin <code>A1:C5</code> (kolme saraketta, viisi riviä), ja palauttaa kaikki rivit, joiden nimetystä sarakkeesta “var1” löytyy arvo, joka itsessään on määritelty solussa <code>E1</code>. Jos solussa <code>E1</code> lukee esimerkiksi 2, funktio palauttaa säännön <code>var1 = 2</code> mukaan; jos siinä lukee “b”, funktio palauttaa säännön <code>var1 = "b"</code> mukaan, ja niin eteenpäin. Jos palautettavia arvoja ei ole ollenkaan, funktio palauttaa tekstijonon “Ei löydy!”. HUOM: Jos nimeä “var1” ei olla määritelty, funktio palauttaa virheen (luultavasti <code>#NIMI!</code>, koska nimi on väärin).</p>
</section>
<section id="xhaku" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="xhaku"><span class="header-section-number">4.3.5</span> XHAKU</h3>
<p><code>=XHAKU(hakuarvo; hakumatriisi; palautusmatriisi; joseilöydy; vastaavuustila; hakutila)</code></p>
<p>Funktiolla suoritat hakuja alkuperäisestä matriisista ja palautat yhden tai useamman solun. Funktio on hyvin joustava siinä, mitä se palauttaa ja missä muodossa. Avainsanat ovat:</p>
<ul>
<li><code>hakuarvo</code> (pakollinen): Mitä haetaan? Voi olla mikä tahansa Excelissä pätevä datamuoto (esim. luku, päivämäärä, merkkijono, jne.)</li>
<li><code>hakumatriisi</code> (pakollinen): Mistä haetaan? Määrittele joko rivi tai sarake kokonaisuudessaan. Esim. <code>A1:A5</code> hakee sarakkeesta <code>A</code>, <code>var1</code> hakee nimetyltä alueelta “var1”, <code>A1:C1</code> hakee riviltä <code>1</code>. Tämä on siis avainsana, jolla määrittelet, mitä loogista sääntöä yrität täyttää (“hae kaikki rivit, joiden sukupuoli on 2; hae kaikki rivit, joiden bruttotulo on 60 000 euroa”…)</li>
<li><code>palautusmatriisi</code> (pakollinen): Miltä alueelta palautetaan? Määrittele joko rivi tai sarake kokonaisuudessaan. Tämä avainsana määrittelee siis, mikä arvo palautetaan, kun olet löytänyt hakuarvon määritetystä hakumatriisista (“kun olet löytänyt kaikki rivit, joiden sukupuoli on 2, palauta niiden bruttovuositulot”).</li>
<li><code>joseilöydy</code> (valinnainen): Mitä palautetaan, jos mitään ei löydy? Jos ei määritellä tätä avainsanaa, funktio palauttaa virhearvon <code>#PUUTTUU!</code> jos palautettavaa ei löydy.</li>
<li><code>vastaavuustila</code> (valinnainen): Miten tarkasti haetaan? Oletusasetuksena funktio hakee tarkan vastaavuuden, ja palauttaa <code>#PUUTTUU!</code> jos sitä ei löydy. Voit myös määritellä yhden seuraavista: <code>-1</code> palauttaa tarkan vastaavuuden tai seuraavaksi pienimmän kohteen, <code>1</code> palauttaa tarkan vastaavuuden tai seuraavaksi suuremman kohteen, <code>2</code> hakee laajalla vastaavuudella, jossa voit käyttää villikorttimerkkejä <code>*, ?, ~</code>.</li>
<li><code>hakutila</code> (valinnainen): Miten ja missä järjestyksessä haku suoritetaan? Oletuksena haku suoritetaan ensimmäisestä kohteesta alkaen (<code>1</code>), voit myös määritellä sen suoritettavan viimeisestä kohteesta (<code>-1</code>), binaarihaku nousevassa järjestyksessä (<code>2</code>) tai binaarihaku laskevassa järjestyksessä (<code>-2</code>). Binaarihaut ovat nopeampia, mutta vaativat, että matriisi on valmiiksi järjestetty kyseiseen järjestykseen - muutoin ne palauttavat virheellisiä tuloksia.</li>
</ul>
<p>[TÄHÄN PAREMPI SELITYS XHAUN TOIMINNASTA.]</p>
</section>
<section id="lajittelufunktiot" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="lajittelufunktiot"><span class="header-section-number">4.3.6</span> Lajittelufunktiot</h3>
<p><code>=LAJITTELE(matriisi; lajitteluindeksi; lajittelujärjestys; sarmukaan)</code>, <code>=LAJITTELE.ARVOJEN.PERUSTEELLA(matriisi; mukaan1; järjestys1; mukaan2; järjestys2; ...)</code></p>
<p>Funktiot hakevat alkuperäisen matriisin, lajittelevat sen tietyn säännön mukaan, ja palauttavat lajiteltun matriisin.</p>
<p><strong>LAJITTELE</strong>-funktiossa määrittelet ensin mikä <code>matriisi</code>-alue lajitellaan. Jos valitset useamman rivin/sarakkeen, voit myös määritellä, minkä rivin/sarakkeen mukaan lajitellaan avainsanalla <code>lajitteluindeksi</code>. Avainsana <code>lajittelujärjestys</code> määrittelee, onko lajittelu nousevassa (<code>1</code>, oletus) vai laskevassa (<code>-1</code>) järjestyksessä. Avainsanalla <code>sarmukaan</code> voit määritellä, lajitellaanko rivin (<code>EPÄTOSI</code>, oletus) vai sarakkeen (<code>TOSI</code>) mukaan.</p>
<p><strong>LAJITTELE.ARVOJEN.PERUSTEELLA</strong>-funktio tekee melkein saman, mutta sillä voit määritellä useamman lajittelualueen ja -järjestyksen. Funktio lajittelee ensin alueen <code>mukaan1</code> mukaan, järjestyksessä <code>järjestys1</code> (samat arvot ja oletukset kuin <code>lajittelujärjestys</code> yllä), sitten alueen <code>mukaan2</code> ja järjestyksen <code>järjestys2</code> mukaan, ja niin eteenpäin.</p>
<p>Yhdistelemällä <code>LAJITTELE</code>- ja <code>SUODATA</code>-funktioita voit rakentaa joustavia ja (suht) nopeasti käytettävissä olevia ehdollisia hakuja tiedossasi. Haluatko kaikki vastaajat, joiden bruttotulot ovat vähintään 50 000 euroa, järjestettynä koulutustason mukaan? Onnistuu: <code>=LAJITTELE.ARVOJEN.PERUSTEELLA(SUODATA(datamatriisi; bruttotulot &gt;= 50000); koulutustaso)</code>.</p>
</section>
<section id="ota" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="ota"><span class="header-section-number">4.3.7</span> OTA</h3>
<p><code>=OTA(matriisi; rivit; sarakkeet)</code></p>
<p>Funktio palauttaa matriisista määritetyn määrän rivejä (pakollinen) ja sarakkeita (valinnainen). Rivit ja sarakkeet määritetään määrässä (esim. 2 tai 5 riviä). Negatiiviset numerot hakevat matriisin lopusta.</p>
</section>
<section id="transponoi" class="level3" data-number="4.3.8">
<h3 data-number="4.3.8" class="anchored" data-anchor-id="transponoi"><span class="header-section-number">4.3.8</span> TRANSPONOI</h3>
<p><code>=TRANSPONOI(matriisi)</code></p>
<p>Funktio kääntää alkuperäisen matriisin siten, että riveistä tulee sarakkeita ja sarakkeista rivejä.</p>
<p>Alueen, johon funktio palauttaa käännetyn matriisin, voi määritellä joko dynaamisesti (lisäämällä funktio vasempaan yläkulmaan ja painamalla Enter) tai eksplisiittisesti (maalaamalla ensin koko alue, ja kirjoittamalla funktio suoraan alueeseen. Lopussa painetaan <code>Ctrl + Shift + Enter</code>, jotta funktio täyttää koko alueen eksplisiittisesti eikä dynaamisesti).</p>
</section>
<section id="ainutkertaiset.arvot" class="level3" data-number="4.3.9">
<h3 data-number="4.3.9" class="anchored" data-anchor-id="ainutkertaiset.arvot"><span class="header-section-number">4.3.9</span> AINUTKERTAISET.ARVOT</h3>
<p><code>=AINUTKERTAISET.ARVOT(matriisi; sarmukaan; vainkerran)</code></p>
<p>Funktio palauttaa matriisin kaikki uniikit (ainutkertaiset) arvot. Valinnaisella loogisella avainsanalla <code>sarmukaan</code> funktio palauttaa uniikit sarakkeet (<code>TOSI</code>) rivien sijaan (<code>EPÄTOSI</code> tai jätetty pois). Valinnaisella loogisella avainsanalla <code>vainkerran</code> voit määritellä, että funktio palauttaa vain ne uniikit arvot, jotka esiintyvät vain yhden kerran matriisissa (useamman kerran sijaan).</p>
</section>
</section>
<section id="matemaattiset-ja-trigonometriset-funktiot" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="matemaattiset-ja-trigonometriset-funktiot"><span class="header-section-number">4.4</span> Matemaattiset ja trigonometriset funktiot</h2>
<p>Koska matemaattisia ja trigonometrisia funktioita löytyy hyvin suuri määrä Excelissä, avaan tässä luvussa vain yleisimmät, tilastotieteen käytössä olevat funktiot. Tarkista koko luettelo Excelin opassivuilla.</p>
<section id="trigonometriset-funktiot" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="trigonometriset-funktiot"><span class="header-section-number">4.4.1</span> Trigonometriset funktiot</h3>
<p>Trigonometrisia funktioita on suuri määrä Excelissä. Jokaiselle funktiolle annetaan alkuperäinen arvo avainsanana (<code>=FUNKTIO(arvo)</code>). Excelissä löytyy yleisimmät identiteettifunktiot sekä niiden hyperboliset versiot (aina jälkiliitteellä <code>H</code> funktion nimessä). Katso Excelin opassivut (linkitetty tämän sivun alussa) kaikista funktioista.</p>
</section>
<section id="itseisarvo" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="itseisarvo"><span class="header-section-number">4.4.2</span> ITSEISARVO</h3>
<p><code>=ITSEISARVO(arvo)</code></p>
<p>Palauttaa arvon itseisarvon, eli absoluuttisen arvon.</p>
</section>
<section id="kooste-ja-välisumma" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="kooste-ja-välisumma"><span class="header-section-number">4.4.3</span> KOOSTE ja VÄLISUMMA</h3>
<p><code>=KOOSTE(funktio; asetukset; matriisi; k)</code></p>
<p><code>=VÄLISUMMA(funktio; viittaus)</code></p>
<p><strong>KOOSTE</strong>-funktio palauttaa yleisiä koostefunktioita määrätylle matriisiviittaukselle. Funktio toimii siten niin sanottuna wrapper-funktiona, eli sille syötetään, mikä funktio halutaan ajaa matriisilla.</p>
<p><strong>VÄLISUMMA</strong>-funktio tekee saman, mutta on yksinkertaisempi. Funktio ei ota asetuksia.</p>
<p>Pakollisella avainsanalla <code>funktio</code> määrittelet, minkä luvun haluat laskea. Vaihtoehtoja on yhteensä 19, numeroituna 1-19:</p>
<ol type="1">
<li>KESKIARVO</li>
<li>LASKE</li>
<li>LASKE.A</li>
<li>MAKS</li>
<li>MIN</li>
<li>TULO</li>
<li>KESKIHAJONTA.S</li>
<li>KESKIHAJONTA.P</li>
<li>SUMMA</li>
<li>VAR.S</li>
<li>VAR.P</li>
<li>MEDIAANI</li>
<li>MOODI.YKSI</li>
<li>SUURI</li>
<li>PIENI</li>
<li>PROSENTTIPISTE.SIS</li>
<li>NELJÄNNES.SIS</li>
<li>PROSENTTIPISTE.ULK</li>
<li>NELJÄNNES.ULK</li>
</ol>
<p>Klikkaa nimiä hypätäksesi jokaisen funktion määritelmälle tällä sivulla. Tämä luettelo näkyy myös, kun kirjoitat funktiota Excelissä, joten sinun ei tarvitse osata sitä ulkoa.</p>
<p><code>VÄLISUMMA</code>-funktiossa voit käyttää vain ensimmäistä yhtätoista funktiota (eli KESKIARVOsta VAR.P:hen).</p>
<p>Pakollisella avainsanalla <code>asetukset</code> määrittelet, mitkä eri arvot ohitetaan laskussa. Jos funktio löytää näitä arvoja matriisin sisällä, se seuraa tässä määriteltyä logiikkaa. Asetuksia on kahdeksan:</p>
<ol start="0" type="1">
<li>Ohittaa VÄLISUMMA- ja KOOSTE-funktiot.</li>
<li>Ohittaa piiloitetut rivit, VÄLISUMMA- ja KOOSTE-funktiot.</li>
<li>Ohittaa virhearvot, VÄLISUMMA- ja KOOSTE-funktiot.</li>
<li>Ohittaa piiloitetut rivit, virhearvot, VÄLISUMMA- ja KOOSTE-funktiot.</li>
<li>Ei ohita mitään.</li>
<li>Ohittaa piiloitetut rivit.</li>
<li>Ohittaa virhearvot.</li>
<li>Ohittaa piiloitetut rivit ja virhearvot.</li>
</ol>
<p>HUOM: Funktio ei ohita asioita, jos funktion sisällä tehdään laskutoimitus! Tällöin ohitus pitää tehdä laskutoimituksen sisällä, esim. käyttäen JOS- ja ONVIRH-rakenteita.</p>
<p><code>VÄLISUMMA</code>-funktio ei ota asetuksia, mutta muokkaamalla funktionumeroa voit ohittaa piiloitetut rivit. Funktiot 1-9 määritellään ohittamaan piiloitetut rivit lisäämällä <code>10</code> niiden etuliitteeksi: 101, 102, 103, jne. Funktiot 10 ja 11 ottavat numeron <code>1</code> etuliitteeksi: 110 on VAR ja 111 on VAR.P.</p>
<p>Pakollisella avainsanalla <code>matriisi</code> määrittelet alueen, jolle haluat laskea kyseisen laskufunktion.</p>
<p>Viimeinen avainsana, <code>k</code>, on pakollinen tietyillä laskufunktioilla. Funktioilla SUURI ja PIENI määrittelet, minkä k:n suurimman/pienimmän arvon haluat. PROSENTTIPISTE-funktioilla <code>k</code> määrittelee, minkä k:nnen prosenttipisteen arvon haluat. NELJÄNNES-funktoilla <code>k</code> määrittelee, minkä neljänneksen haluat.</p>
</section>
<section id="parillinen-ja-pariton" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="parillinen-ja-pariton"><span class="header-section-number">4.4.4</span> PARILLINEN ja PARITON</h3>
<p><code>=PARILLINEN(arvo)</code>, <code>=PARITON(arvo)</code></p>
<p>Funktiot pyöristävät luvun ylöspäin lähimpään parilliseen tai parittomaan kokonaislukuun.</p>
</section>
<section id="eksponentti" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="eksponentti"><span class="header-section-number">4.4.5</span> EKSPONENTTI</h3>
<p><code>=EKSPONENTTI(arvo)</code></p>
<p>Palauttaa arvon <span class="math inline">\(e^\text{arvo}\)</span>.</p>
</section>
<section id="kertoma" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="kertoma"><span class="header-section-number">4.4.6</span> KERTOMA</h3>
<p><code>=KERTOMA(arvo)</code></p>
<p>Palauttaa arvon kertoman, eli faktoriaalin. Luvun faktoriaali on yhtä kuin sarja</p>
<p><span class="math display">\[\prod_{i=1}^{n}{i}\]</span></p>
<p>Jos luku on 5, niin <code>KERTOMA(5)</code> palauttaa <span class="math inline">\(5*4*3*2*1=120\)</span>.</p>
</section>
<section id="pyöristysfunktiot" class="level3" data-number="4.4.7">
<h3 data-number="4.4.7" class="anchored" data-anchor-id="pyöristysfunktiot"><span class="header-section-number">4.4.7</span> Pyöristysfunktiot</h3>
<p><code>=PYÖRISTÄ.KERR(arvo; tarkkuus)</code></p>
<p><code>=PYÖRISTÄ.KERR.ALAS(arvo; tarkkuus)</code></p>
<p><code>=PYÖRISTÄ.KERR.YLÖS(arvo; tarkkuus)</code></p>
<p><code>=PYÖRISTÄ.KERR.ALAS.TARKKA(arvo; tarkkuus)</code></p>
<p><code>=PYÖRISTÄ(arvo; desimaalit)</code></p>
<p><code>=PYÖRISTÄ.DES.ALAS(arvo; desimaalit)</code></p>
<p><code>=PYÖRISTÄ.DES.YLÖS(arvo; desimaalit)</code></p>
<p>Kaikki pyöristysfunktiot toimivat kutakuinkin samalla tavalla ja näyttävät samoilta, mutta pienillä vivahde-eroilla.</p>
<p>Tavallinen pyöristys hoituu funktiolla <code>PYÖRISTÄ</code>, joka ottaa arvon joka pyöristetään, sekä desimaalitarkkuuden numeroissa. Esim. <code>=PYÖRISTÄ(2,673; 1)</code> pyöristää arvon yhden desimaalin tarkkuudelle, eli 2.7. Suunta määräytyy niin kuin matematiikassa yleensä, eli &gt;= 0.5 pyöristetään ylös ja &lt; 0.5 alas.</p>
<p>Jos haluat pyöristää tiettyyn suuntaan, voit käyttää <code>PYÖRISTÄ.DES.ALAS</code> tai <code>PYÖRISTÄ.DES.YLÖS</code>.</p>
<p>Funktioperhe <code>PYÖRISTÄ.KERR</code> pyöristää tiettyä kerrannaisnumeroa kohtaan. Funktio hakee siis lähimmän numeron, jonka voi tasajakaa <code>tarkkuus</code>-arvolla. Pääteliitteet <code>.ALAS</code> ja <code>.YLÖS</code> määrittelevät pyöristyksen suunnan. Yleisfunktiossa <code>PYÖRISTÄ.KERR</code> suunta määräytyy jakojäännöksen perusteella: jos jaosta jää &gt;= puolet kerrannaisen arvosta, se pyöristää ylöspäin, ja muuten alaspäin. Esimerkkinä <code>=PYÖRISTÄ.KERR(10;3)</code> laskee, että kymmenen jaon kolmella jättää yhden jäljelle, mikä on vähemmän kuin puolet kolmesta (&lt;= 1.5), joten se pyöristää alaspäin. Lähin tasajakonumero alaspäin on 9, joten tulos on 9.</p>
</section>
<section id="suurin.yht.tekijä-ja-pienin.yht.jaettava" class="level3" data-number="4.4.8">
<h3 data-number="4.4.8" class="anchored" data-anchor-id="suurin.yht.tekijä-ja-pienin.yht.jaettava"><span class="header-section-number">4.4.8</span> SUURIN.YHT.TEKIJÄ ja PIENIN.YHT.JAETTAVA</h3>
<p><code>=SUURIN.YHT.TEKIJÄ(luku1; luku2; ...)</code>, <code>=PIENIN.YHT.JAETTAVA(luku1; luku2; ...)</code></p>
<p>Funktiot hakevat suurimman tai pienimmän yhteisen tekijän kahdelle tai useammalle arvolle. Nolla on tässä jaettava kaikilla luonnollisilla luvuilla, ja negatiiviset luvut eivät toimi.</p>
</section>
<section id="logaritmit" class="level3" data-number="4.4.9">
<h3 data-number="4.4.9" class="anchored" data-anchor-id="logaritmit"><span class="header-section-number">4.4.9</span> Logaritmit</h3>
<p><code>=LOG(arvo; kanta)</code>, <code>=LOG10(arvo)</code>, <code>=LUONNLOG(arvo)</code></p>
<p>Funktioperhe <code>LOG</code> palauttaa arvon logaritmin. Erikoisfunktiot <code>LOG10</code> ja <code>LUONNLOG</code> palauttavat arvon kymmenkantaisen logaritmin <span class="math inline">\(10^{x}\)</span> ja luonnollisen logaritmin <span class="math inline">\(e^{x}\)</span>. Muut logaritmikannat määritellään <code>LOG</code>-funktion <code>kanta</code>-avainsanalla.</p>
</section>
<section id="jakoj" class="level3" data-number="4.4.10">
<h3 data-number="4.4.10" class="anchored" data-anchor-id="jakoj"><span class="header-section-number">4.4.10</span> JAKOJ</h3>
<p><code>=JAKOJ(luku; jakaja)</code></p>
<p>Funktio palauttaa jäännöksen jakolaskulle <code>luku/jakaja</code>. Jakojäännöksellä on aina sama etumerkki (positiivinen tai negatiivinen) kuin jakajalla.</p>
</section>
<section id="pii" class="level3" data-number="4.4.11">
<h3 data-number="4.4.11" class="anchored" data-anchor-id="pii"><span class="header-section-number">4.4.11</span> PII</h3>
<p><code>=PII()</code></p>
<p>Palauttaa piin arvon 15:lla desimaalilla.</p>
</section>
<section id="satunnaisluvut" class="level3" data-number="4.4.12">
<h3 data-number="4.4.12" class="anchored" data-anchor-id="satunnaisluvut"><span class="header-section-number">4.4.12</span> Satunnaisluvut</h3>
<p><code>=SATUNNAISLUKU()</code>, <code>=SATUNNAISLUKU.VÄLILTÄ(alku; loppu)</code></p>
<p>Funktiot generoivat satunnaislukuja. Perusfunktio <code>SATUNNAISLUKU</code> tuottaa yhden luvun väliltä 0-1, ja funktio <code>SATUNNAISLUKU.VÄLILTÄ</code> tuottaa luvun väliltä <code>alku-loppu</code>. Luvut generoidaan Mersenne Twister -algoritmilla, ja tuotetaan uudelleen joka kerta, kun kaavat lasketaan uudelleen.</p>
</section>
<section id="neliöjuuret" class="level3" data-number="4.4.13">
<h3 data-number="4.4.13" class="anchored" data-anchor-id="neliöjuuret"><span class="header-section-number">4.4.13</span> Neliöjuuret</h3>
<p><code>=NELIÖJUURI(arvo)</code>, <code>=NELIÖJUURI.PII(arvo)</code></p>
<p>Funktiot laskevat arvon neliöjuuren. Perusfunktio laskee tavallisen neliöjuuren (positiivisen), <code>NELIÖJUURI.PII</code> kertoo ensin arvon piillä ja laskee sitten neliöjuuren.</p>
</section>
<section id="summat" class="level3" data-number="4.4.14">
<h3 data-number="4.4.14" class="anchored" data-anchor-id="summat"><span class="header-section-number">4.4.14</span> Summat</h3>
<p><code>=SUMMA(alue)</code></p>
<p><code>=SUMMA.JOS(alue; ehto)</code></p>
<p><code>=SUMMA.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)</code></p>
<p>Summafunktiolla lasket yhteen määrätyn alueen kaikki arvot. Voit asettaa ehdon summaukselle käyttämällä <code>SUMMA.JOS</code>-funktiota, jolloin arvot summataan yhteen vain silloin, kun ne täyttävät loogisen ehdon <code>ehto</code>-avainsanassa.</p>
<p>Jos haluat määritellä useita ehtoja, tai jos ehdot riippuvat jonkun toisen alueen arvoista, voit käyttää <code>SUMMA.JOS.JOUKKO</code>-komentoa. Jokainen ehto määritellään alue-ehto-parina, jossa <code>ehtoalue</code> määrittelee, millä alueella ehto tarkistetaan, ja <code>ehto</code> määrittelee itse ehdon. Alue-ehto-pareja voi olla 127 kappaletta.</p>
</section>
<section id="neliösummat" class="level3" data-number="4.4.15">
<h3 data-number="4.4.15" class="anchored" data-anchor-id="neliösummat"><span class="header-section-number">4.4.15</span> Neliösummat</h3>
<p><code>=NELIÖSUMMA(alue)</code></p>
<p><code>=NELIÖSUMMIEN.EROTUS(alue1; alue2)</code></p>
<p><code>=NELIÖSUMMIEN.SUMMA(alue1; alue2)</code></p>
<p><code>=EROTUSTEN.NELIÖSUMMA(alue1; alue2)</code></p>
<p>Tämä funktioperhe laskee neliösummia, jolloin ensin otetaan jokaisen arvon neliö (<span class="math inline">\(x^2\)</span>) ja sitten summataan ne yhteen. Perusfunktio <code>NELIÖSUMMA</code> tekee tämän arvosarjalle, esim. kokonaiselle sarakkeelle tai riville. Kaava tälle on: <span class="math inline">\(\sum{x^2}\)</span></p>
<p>Kolme seuraavaa toimivat kahdella alueella, ja tekevät eri asioita riippuen funktiosta:</p>
<ul>
<li><code>NELIÖSUMMIEN.EROTUS</code> laskee kahden alueen jokaisen arvon neliön, vähentää ne toisistaan (alue2 - alue1) ja summaa lopputuloksen yhteen. Kaava on: <span class="math inline">\(\sum{x^2-y^2}\)</span></li>
<li><code>NELIÖSUMMIEN.SUMMA</code> laskee kahden alueen jokaisen arvon neliön ja summaa ne yhteen. Kaava on: <span class="math inline">\(\sum{x^2 + y^2}\)</span></li>
<li><code>EROTUSTEN.NELIÖSUMMA</code> laskee ensin kahden alueen jokaisen arvon eron (alue2 - alue1), ottaa tuloksen neliön ja summaa kaikki nämä yhteen. Kaava on: <span class="math inline">\(\sum{(x-y)^2}\)</span></li>
</ul>
</section>
<section id="katkaise" class="level3" data-number="4.4.16">
<h3 data-number="4.4.16" class="anchored" data-anchor-id="katkaise"><span class="header-section-number">4.4.16</span> KATKAISE</h3>
<p><code>=KATKAISE(luku; numerot)</code></p>
<p>Funktio pudottaa desimaalit annetulta luvulta. Oletusarvona funktio pudottaa kaikki desimaalit, mutta voit myös määritellä kuinka monta jätetään valinnaisella avainsanalla <code>numerot</code>. Huomaa, että funktio <strong>ei</strong> pyöristä, vaan tiputtaa vain pois desimaalit!</p>
</section>
</section>
<section id="tilastolliset-funktiot" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="tilastolliset-funktiot"><span class="header-section-number">4.5</span> Tilastolliset funktiot</h2>
<section id="sijaintiluvut" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="sijaintiluvut"><span class="header-section-number">4.5.1</span> Sijaintiluvut</h3>
<section id="laske-funktiot" class="level4" data-number="4.5.1.1">
<h4 data-number="4.5.1.1" class="anchored" data-anchor-id="laske-funktiot"><span class="header-section-number">4.5.1.1</span> LASKE-funktiot</h4>
<p><code>=LASKE(alue)</code></p>
<p><code>=LASKE.A(alue)</code></p>
<p><code>=LASKE.TYHJÄT(alue)</code></p>
<p><code>=LASKE.JOS(alue; ehto)</code></p>
<p><code>=LASKE.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)</code></p>
<p>Jos haluat laskea, kuinka monta arvoa tietyllä alueella on (esim. laskeaksesi pätevän N:n tietylle laskutoiminnolle), voit käyttää funktiota <code>LASKE</code>. Funktio laskee <strong>vain</strong> luvut, päivämäärät ja tekstimuotoiset luvut joita se voi väkisin muuntaa luvuiksi.</p>
<p>Jos haluat laskea myös totuusarvoja, tekstiä tai virhearvoja, käytä funktiota <code>LASKE.A</code>. Funktio laskee kaikki arvot paitsi tyhjät solut.</p>
<p>Jos haluat laskea nimenomaan tyhjät solut, käytä funktiota <code>LASKE.TYHJÄT</code>. Funktio laskee tyhjät solut sekä solut, joissa on tyhjä teksti ““. Funktio ei laske nollaa!</p>
<p>Voit ehdollistaa laskutoiminnon käyttämällä funktiota <code>LASKE.JOS</code>. Funktio laskee vain ne solut, jotka täyttävät ehdon. Huomaa, että funktio laskee samat arvot kuin perusfunktio <code>LASKE</code>, eli tyhjiä, tekstiä, totuusarvoja tai virheitä ei lasketa mukaan.</p>
<p>Voit myös kirjoittaa useamman ehdon sekä käyttää eri ehtoalueita funktiolla <code>LASKE.JOS.JOUKKO</code>. Ehdot annetaan alue-ehto-pareina, jossa alue määrittelee, millä alueella ehdon on pädettävä alkuperäisen luvun ollakseen mukana laskussa, ja ehto määrittelee itse ehdon. Laskettava alue määritellään <code>alue</code>-avainsanalla, eli laskettava alue voi olla eri kuin ehtoalueet. Tyhjät solut kohdellaan arvona 0, sekä laskussa että ehdoissa.</p>
</section>
<section id="taajuus" class="level4" data-number="4.5.1.2">
<h4 data-number="4.5.1.2" class="anchored" data-anchor-id="taajuus"><span class="header-section-number">4.5.1.2</span> TAAJUUS</h4>
<p><code>=TAAJUUS(alue; lokerot)</code></p>
<p>Funktio palauttaa frekvenssitaulukon. Määrittele ensin <code>alue</code>, josta haluat laskea kaikkien arvojen frekvenssit. Voit määritellä mitkä arvot lasketaan <code>lokerot</code>-alueella, mutta voit myös jättää sen pois, jolloin funktio automaattisesti laskee kaikki ainutlaatuiset arvot ja niiden esiintymiset.</p>
<p>Huomaa, että <code>lokerot</code> tulee määritellä lukujanana! Voit joko kirjoittaa lokeroarvot vierekkäisiin soluihin jonnekin työlehteesi, tai kirjoittaa ne käsin funktioon käyttäen {}-syntaksia.</p>
<p>Jos määrittelet lokerot, voit laskea muuttujan tasoa suhde- tai välimatka-asteikolta järjestysasteikolle. Jokainen lokero jonka määrittelet on raja-arvo; ensimmäinen lokeroarvo on kaikki arvot alle tai yhtä suuria kuin lokeroarvo, toinen on kaikki arvot ensimmäisen ja toisen arvon välillä, jne. Jos siis määrittelet lokeroarvoina matriisialueen jossa on arvot {70, 79, 89}, niin funktio laskee neljä lokeroa: Arvot 70 tai vähemmän, arvot 71-79, arvot 80-89, ja arvot 90 tai enemmän.</p>
</section>
<section id="moodi" class="level4" data-number="4.5.1.3">
<h4 data-number="4.5.1.3" class="anchored" data-anchor-id="moodi"><span class="header-section-number">4.5.1.3</span> Moodi</h4>
<p><code>=MOODI.YKSI(alue)</code>, <code>=MOODI.USEA(alue)</code></p>
<p>Funktiot hakevat lukusarjan moodin, eli useimmiten esiintyvän arvon. Jos odotat vain yhtä moodia, käytä funktiota <code>MOODI.YKSI</code>, mutta huomaa, että sen käyttäytyminen jos se löytää useamman moodin ei ole määritelty! Multimodalisuuden kohdalla käytä funktiota <code>MOODI.USEA</code>, joka palauttaa pystysuuntaisen matriisin. Tämä matriisi sisältää kaikki esiintyvät moodit.</p>
</section>
<section id="mediaani" class="level4" data-number="4.5.1.4">
<h4 data-number="4.5.1.4" class="anchored" data-anchor-id="mediaani"><span class="header-section-number">4.5.1.4</span> MEDIAANI</h4>
<p><code>=MEDIAANI(alue)</code></p>
<p>Funktio hakee lukusarjan mediaanin. Jos mediaaneja on kaksi (eli sarja on parillinen), funktio palauttaa kahden keskimmäisen arvon keskiarvon. Funktio laskee mukaan totuusarvot ja tekstimuotoiset luvut (“1”). Muut arvot antavat joko virheen tai ohitetaan, riippuen siitä, ovatko ne matriisiargumentissa vai suoraan viitattuna.</p>
</section>
<section id="keskiarvo" class="level4" data-number="4.5.1.5">
<h4 data-number="4.5.1.5" class="anchored" data-anchor-id="keskiarvo"><span class="header-section-number">4.5.1.5</span> Keskiarvo</h4>
<p><code>=KESKIARVO(alue)</code></p>
<p><code>=KESKIARVO.JOS(alue; ehto; keskiarvoalue)</code></p>
<p><code>=KESKIARVO.JOS.JOUKKO(keskiarvoalue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)</code></p>
<p>Yleisen aritmeettisen keskiarvon voit laskea funktiolla <code>KESKIARVO</code>.</p>
<p>Jos haluat ehdollistaa mitkä luvut valitaan keskiarvoon, voit käyttää funktiota <code>KESKIARVO.JOS</code>. Lisää ehto avainsanaan <code>ehto</code>. Ehto päteää alueeseen joka määriteltiin avainsanalla <code>alue</code>; jos haluat laskea keskiarvon jollekin muulle alueelle (esim. toiselle muuttujalle kuin ehtomuuttuja), määrittele se avainsanalla <code>keskiarvoalue</code>.</p>
<p>Jos haluat laskea keskiarvon käyttäen useampaa eri ehtoa, käytä funktiota <code>KESKIARVO.JOS.JOUKKO</code>. Ehdot syötetään aina alue-ehto-parina, jossa alue määrittelee miltä alueelta ehto tarkastetaan, ja ehto määrittelee itse ehdon.</p>
</section>
</section>
<section id="hajontaluvut" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="hajontaluvut"><span class="header-section-number">4.5.2</span> Hajontaluvut</h3>
<section id="pienin-suurin-ja-raja-arvot" class="level4" data-number="4.5.2.1">
<h4 data-number="4.5.2.1" class="anchored" data-anchor-id="pienin-suurin-ja-raja-arvot"><span class="header-section-number">4.5.2.1</span> Pienin, suurin, ja raja-arvot</h4>
<p><code>=MIN(alue)</code>, <code>=MAKS(alue)</code></p>
<p><code>=MIN.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)</code></p>
<p><code>=MAKS.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)</code></p>
<p><code>=PIENI(alue; k)</code>, <code>=SUURI(alue; k)</code></p>
<p><code>=PROSENTTIPISTE.SIS(alue; k)</code>, <code>=PROSENTTIPISTE.ULK(alue; k)</code></p>
<p><code>=NELJÄNNES.SIS(alue; neljännes)</code>, <code>=NELJÄNNES.ULK(alue; neljännes)</code></p>
<p>Voit hakea alueen pienimmän ja suurimman arvon funktioilla <code>MIN</code> (minimi) ja <code>MAKS</code> (maksimi).</p>
<p>Voit myös ehdollistaa minimi- ja maksimihaun funktioilla <code>MIN.JOS.JOUKKO</code> ja <code>MAKS.JOS.JOUKKO</code>. Jokainen ehto määritellään alue-ehto-parina, jossa alue määrittelee, missä ehdon tulee pädetä, ja ehto määrittelee itse ehdon. Muista myös määritellä itse laskenta-alue avainsanalla <code>alue</code>!</p>
<p>Jos haluat hakea alueen <code>k</code>:nnen pienimmän tai suurimman arvon, käytä funktioita <code>PIENI</code> ja <code>SUURI</code>. Raja-arvo määritellään omalla avainsanallaan, <code>k</code>.</p>
<p>Jos haluat hakea tietyn fraktiilin persentiilinä, käytä funktioita <code>PROSENTTIPISTE.SIS</code> tai <code>PROSENTTIPISTE.ULK</code>. Molemmat funktiot ottavat alueen sekä arvon <code>k</code>, joka on persentiili ilmaistuna desimaalilukuna. Loppupääte <code>SIS/ULK</code> määrittelee kuuluuko raja-arvo itsessään fraktiilin sisälle (<code>SIS</code>) vai ei (<code>ULK</code>).</p>
<p>Neljännekset, eli kvartiilit, voi hakea myös funktioilla <code>=NELJÄNNES.SIS</code> ja <code>=NELJÄNNES.ULK</code>. Kvartiilin numero ilmaistaan numeroina 0-4: Pienin arvo (0), ensimmäinen neljännes (1), toinen neljännes eli mediaani (2), kolmas neljännes (3), tai suurin arvo (4). Kvartiilinumerot 0, 2 ja 4 vastaavat tuloksia funktioista <code>MIN</code>, <code>MEDIAANI</code> ja <code>MAKS</code> <strong>vain</strong> jos käytät funktiota <code>NELJÄNNES.SIS</code>. Loppupääte määrittelee kuuluuko raja-arvo neljänneksen sisälle (<code>SIS</code>) vai ei (<code>ULK</code>).</p>
</section>
<section id="kurtoosi-ja-vinouma" class="level4" data-number="4.5.2.2">
<h4 data-number="4.5.2.2" class="anchored" data-anchor-id="kurtoosi-ja-vinouma"><span class="header-section-number">4.5.2.2</span> Kurtoosi ja vinouma</h4>
<p><code>=KURT(alue)</code>, <code>=JAKAUMAN.VINOUS(alue)</code></p>
<p>Funktiot laskevat alueen kurtoosin tai vinouman.</p>
<p>Excelissä kurtoosi annetaan keskitettynä nollalle, jolloin positiivinen kurtoosi tarkoittaa terävää jakaumaa ja negatiivinen kurtoosi tarkoittaa leveää jakaumaa.</p>
<p>Positiivinen vinouma tarkoittaa, että arvoja löytyy enemmän keskiarvon yllä, ja negatiivinen että arvoja löytyy keskiarvon alla.</p>
</section>
<section id="keskipoikkeama" class="level4" data-number="4.5.2.3">
<h4 data-number="4.5.2.3" class="anchored" data-anchor-id="keskipoikkeama"><span class="header-section-number">4.5.2.3</span> KESKIPOIKKEAMA</h4>
<p><code>=KESKIPOIKKEAMA(alue)</code></p>
<p>Funktio laskee alueen keskipoikkeaman. Keskipoikkeama lasketaan kaavalla:</p>
<p><span class="math display">\[\frac{\sum{x-\bar{x}}}{n}\]</span></p>
</section>
<section id="oikaistu-neliösumma" class="level4" data-number="4.5.2.4">
<h4 data-number="4.5.2.4" class="anchored" data-anchor-id="oikaistu-neliösumma"><span class="header-section-number">4.5.2.4</span> Oikaistu neliösumma</h4>
<p><code>=OIKAISTU.NELIÖSUMMA(alue)</code></p>
<p>Funktio laskee alueen oikaistun neliösumman (engl. <em>deviance</em>). Oikaistu neliösumma lasketaan kaavalla:</p>
<p><span class="math display">\[\sum{(x-\bar{x})^2}\]</span></p>
</section>
<section id="varianssi" class="level4" data-number="4.5.2.5">
<h4 data-number="4.5.2.5" class="anchored" data-anchor-id="varianssi"><span class="header-section-number">4.5.2.5</span> Varianssi</h4>
<p><code>=VAR.S(alue)</code></p>
<p>Funktio palauttaa alueen varianssin. Varianssi lasketaan kaavalla:</p>
<p><span class="math display">\[ s^2 = \frac{\sum{(x-\bar{x})^2}} {n-1} \]</span></p>
<p>Varianssi on siten oikaistu neliösumma jaettuna datapisteiden määrällä minus yksi. Varianssi ilmaistaan alkuperäisen arvoasteikon neliönä (esim. neliöeuroa, neliöyksikköä).</p>
</section>
<section id="keskihajonta" class="level4" data-number="4.5.2.6">
<h4 data-number="4.5.2.6" class="anchored" data-anchor-id="keskihajonta"><span class="header-section-number">4.5.2.6</span> Keskihajonta</h4>
<p><code>=KESKIHAJONTA.S(alue)</code></p>
<p>Funktio laskee alueen keskihajonnan (engl. <em>standard deviation</em>). Keskihajonta lasketaan kaavalla:</p>
<p><span class="math display">\[ \sigma = \sqrt{\frac{\sum{(x-\bar{x})^2}} {n-1}} \]</span></p>
<p>Keskihajonta on siten varianssin neliöjuuri. Keskihajonta mitataan samalla asteikolla kuin alkuperäiset arvot.</p>
</section>
<section id="z-arvo" class="level4" data-number="4.5.2.7">
<h4 data-number="4.5.2.7" class="anchored" data-anchor-id="z-arvo"><span class="header-section-number">4.5.2.7</span> Z-arvo</h4>
<p><code>=NORMITA(x; keskiarvo; keskihajonta)</code></p>
<p>Palauttaa arvon normitetun z-arvon. Funktiolle pitää antaa arvo, joka halutaan normittaa (<code>x</code>) sekä jakauman <code>keskiarvo</code> ja <code>keskihajonta</code>.</p>
<p>Z-arvo lasketaan kaavalla:</p>
<p><span class="math display">\[ z = \frac{x - \bar{x}} {\sigma} \]</span></p>
</section>
</section>
<section id="univariaatit-testit" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="univariaatit-testit"><span class="header-section-number">4.5.3</span> Univariaatit testit</h3>
<section id="z-testi" class="level4" data-number="4.5.3.1">
<h4 data-number="4.5.3.1" class="anchored" data-anchor-id="z-testi"><span class="header-section-number">4.5.3.1</span> Z-testi</h4>
<p><code>=Z.TESTI(alue; x; sigma)</code></p>
<p>Funktio laskee z-testin yksisuuntaisen p-arvon.</p>
<p>Määrittele testattava arvo avainsanalla <code>x</code>, ja alue, jota vastaan testaat avainsanalla <code>alue</code>. Testi testaa tuolloin, eroaako arvo <code>x</code> alueen keskiarvosta merkitsevästi. Toisin sanoin: kuinka suurella todennäköisyydellä saisit arvon <code>x</code> tai isomman, jos sen todellinen arvo onkin alueen keskiarvo eikä <code>x</code>.</p>
<p>Valinnaisella avainsanalla <code>sigma</code> voit antaa populaation tunnetun keskihajonnan. Jos jätät sen pois, keskihajonta estimoidaan otoksesta. Useimmiten sinun tulee jättää se pois.</p>
<p>Jos haluat laskea kaksisuuntaisen z-testin yksisuuntaisen sijaan (eli jos x:n ero keskiarvoon saa mennä kumpaan tahansa suuntaan), voit käyttää seuraavaa kaavaa:</p>
<p><code>= 2 * MIN( Z.TESTI(); 1 - Z.TESTI() )</code></p>
<p><strong>Funktio ei laske testisuuretta!</strong> Jotta voit raportoida koko testin, sinun tulee myös laskea testisuure käsin. Voit käyttää <code>NORMITA</code>-funktiota laskeaksesi <code>x</code>-arvon z-normitetun arvon, jonka raportoit yhteydessä Z-testin palauttaman p-arvon kanssa.</p>
</section>
</section>
<section id="bivariaatit-testit" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="bivariaatit-testit"><span class="header-section-number">4.5.4</span> Bivariaatit testit</h3>
<section id="kovarianssi" class="level4" data-number="4.5.4.1">
<h4 data-number="4.5.4.1" class="anchored" data-anchor-id="kovarianssi"><span class="header-section-number">4.5.4.1</span> KOVARIANSSI</h4>
<p><code>=KOVARIANSSI.S(matriisi1; matriisi2)</code></p>
<p>Funktio laskee kahden matriisin yhteisen kovarianssin. Funktio olettaa, että matriisit ovat yhtä suuria otoksia kokonaispopulaatiosta. Funktio ohittaa tekstit, totuusasvot ja tyhjät solut, mutta ottaa huomioon nollan.</p>
</section>
<section id="korrelaatiokertoin" class="level4" data-number="4.5.4.2">
<h4 data-number="4.5.4.2" class="anchored" data-anchor-id="korrelaatiokertoin"><span class="header-section-number">4.5.4.2</span> Korrelaatiokertoin</h4>
<p><code>=PEARSON(matriisi1; matriisi2)</code></p>
<p><code>=PEARSON.NELIÖ(matriisi1; matriisi2)</code></p>
<p>Funktio <code>PEARSON</code> palauttaa kahden matriisin Pearsonin tulomomenttikorrelaatiokertoimen, <em>r</em>:n.&nbsp;Pearsonin korrelaatio lasketaan kaavalla:</p>
<p><span class="math display">\[ r = \frac{\sum{(x-\bar{x})(y-\bar{y})}} {\sqrt{\sum{(x-\bar{x})^2}\sum{(y-\bar{y})^2}}} \]</span></p>
<p>Funktio <code>PEARSON.NELIÖ</code> laskee ensin <em>r</em>:n, ja palauttaa sitten sen neliön, <span class="math inline">\(r^2\)</span>. Voit tehdä saman ottamalla PEARSON-funktion tulokseen neliön.</p>
</section>
<section id="khiin-neliön-testi" class="level4" data-number="4.5.4.3">
<h4 data-number="4.5.4.3" class="anchored" data-anchor-id="khiin-neliön-testi"><span class="header-section-number">4.5.4.3</span> Khiin neliön testi</h4>
</section>
<section id="t-testi" class="level4" data-number="4.5.4.4">
<h4 data-number="4.5.4.4" class="anchored" data-anchor-id="t-testi"><span class="header-section-number">4.5.4.4</span> T-testi</h4>
<p><code>=T.TESTI(matriisi1; matriisi2; suunta; laji)</code></p>
<p>Funktio laskee t-testin p-arvon.</p>
<p>Ensimmäiset kaksi avainsanaa määrittelevät kaksi matriisia, joita halutaan verrata toisiinsa. Avainsanalla <code>suunta</code> määrittelet, käytätkö yksisuuntaista (1) vai kaksisuuntaista (2) jakaumaa. Avainsanalla <code>laji</code> määrittelet t-testin lajin seuraavista:</p>
<ol type="1">
<li>Parittainen t-testi samasta otoksesta (ns. within-group)</li>
<li>Kahden otoksen t-testi, saman varianssin oletus (homoskedastinen; ns. between-groups)</li>
<li>Kahden otoksen t-testi, erisuuren varianssin oletus (heteroskedastinen; ns. between-groups)</li>
</ol>
<p>Huomaa, että laji 1 ei toimi, jos matriiseissa on eri määrät arvoja.</p>
<p><strong>Funktio ei laske testisuuretta!</strong> Joudut laskemaan testisuureen käsin. Kaavat riippuvat siitä, lasketko parittaisen (<a href="#eq-t-1">Yhtälö&nbsp;<span>4.1</span></a>) vai kahden otoksen t-testin, sekä oletatko saman (<a href="#eq-t-2">Yhtälö&nbsp;<span>4.2</span></a>) vai erisuuren (<a href="#eq-t-3">Yhtälö&nbsp;<span>4.3</span></a>) varianssin.</p>
<p><strong>Parittaisen t-testin</strong> kaava on:</p>
<p><span id="eq-t-1"><span class="math display">\[
t = \frac{1/n\sum{x-y}} {\sigma/\sqrt{N}}
\tag{4.1}\]</span></span></p>
<p><span class="math inline">\(1/n\sum{x-y}\)</span> on erotuksen keskiarvo<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, <span class="math inline">\(\sigma\)</span> on erotuksen keskihajonta, ja <span class="math inline">\(\sqrt{N}\)</span> on otoskoon neliöjuuri. Laske ensin muuttujien väliset erotukset uudeksi muuttujaksi. Laske sitten tämän muuttujan keskiarvo ja keskihajonta. Syötä viimeiseksi nämä, sekä otoskoon neliöjuuri, kaavaan. Lopputulos on parittaisen t-testin testisuure.</p>
<p><strong>Kahden otoksen homoskedastisen t-testin</strong> kaava on:</p>
<p><span id="eq-t-2"><span class="math display">\[
t = \frac{\bar{x} - \bar{y}} {\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}
\tag{4.2}\]</span></span></p>
<p><span class="math inline">\(\bar{x} - \bar{y}\)</span> on molempien otosten keskiarvojen ero. <span class="math inline">\(\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\)</span> on erotuksen keskihajonta, joka koostuu useammasta asiasta. Voit kuitenkin laskea nämä helpommin Excelissä. Laske ensin molempien ryhmien keskiarvot ja niiden erotus. Laske sitten molempien ryhmien keskihajonnat, jaa ne ryhmien otoskoolla, ja summaa tulokset yhteen. Ota tämän tuloksen neliöjuuri. Viimeiseksi, jaa aikaisemmin laskettu keskiarvoerotus neliöjuuren tuloksella. Lopputulos on kahden otoksen homoskedastisen t-testin testisuure.</p>
<p><strong>Kahden otoksen heteroskedastisen t-testin</strong> kaava on:</p>
<p><span id="eq-t-3"><span class="math display">\[
\begin{split}
t = \frac{\bar{x} - \bar{y}} {\sqrt{\frac{s^2_p}{n_1} + \frac{s^2_p}{n_2}}}
\\
s^2_p = \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2} {n_1 + n_2 - 2}
\end{split}
\tag{4.3}\]</span></span></p>
<p>T-testin jaon yläpuoli on sama kuin homoskedastisessa testissä, mutta alaosa on muuttunut. Sen sijaan, että käytettäisiin erotusten keskihajontaa, käytetään niin sanottua ryhmitettyä varianssia (engl. <em>pooled variance</em>), <span class="math inline">\(s^2_p\)</span>. Se koostuu molempien otosten otoskoista <span class="math inline">\(n_1\)</span> ja <span class="math inline">\(n_2\)</span>, sekä otosten yksittäisistä variansseista <span class="math inline">\(s_1\)</span> ja <span class="math inline">\(s_2\)</span>.</p>
<p>Koska nämä funktiot ovat pitkiä ja hankalia, olen tehnyt valmiit lambda-funktiot Exceliin, joita voitte käyttää. [LISÄÄ LAMBDA-FUNKTIOT!]</p>
</section>
</section>
</section>
<section id="tekstifunktiot" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="tekstifunktiot"><span class="header-section-number">4.6</span> Tekstifunktiot</h2>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Jonkun asian jakaminen n:llä on sama kuin sen kertominen 1/n:llä. Tämä osuus on vain yleinen keskiarvolaskelma, vaikka kirjoitettuna hieman eri muotoon.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopioitu!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopioitu!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sijaintiluvut.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sijaintiluvut</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">Viiteluettelo</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>