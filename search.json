[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Kvantitatiiviset menetelmät, syksy 2023",
    "section": "",
    "text": "Aluksi\nTämä verkkokirja sisältää lisämateriaaleja Pelastusopiston kurssille Kvantitatiiviset menetelmät.\nKirja on jaettu lukuihin sisällön mukaan. Voit selata lukuja navigointipalkista, joka löytyy oikealta (iso näyttö, esim. tietokone) tai ylhäältä (pieni näyttö, esim. puhelin).\nMukavia tilastollisia työhetkiä!"
  },
  {
    "objectID": "index.html#tekijänoikeudet",
    "href": "index.html#tekijänoikeudet",
    "title": "Kvantitatiiviset menetelmät, syksy 2023",
    "section": "Tekijänoikeudet",
    "text": "Tekijänoikeudet\nTämä verkkokirja käyttää Creative Commons Nimeä-EiKaupallinen 4.0 Kansainvälinen (CC BY-NC 4.0) -lisenssiä. Voit vapaasti kopioida, levittää ja jakaa verkkokirjan sisältöä missä tahansa muodossa, sekä muokata uudelleen verkkokirjan sisältöä. Sinun on kuitenkin viitattava alkuperäiseen verkkokirjaan, nimetä lisenssi käytössäsi, sekä merkittävä kaikki muutokset, jotka olet tehnyt. Verkkokirjaa ei saa käyttää kaupallisiin tarkoituksiin."
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2\n\n\n\n\n\n\nKnuth, Donald E. 1984. ”Literate Programming”. Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97."
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "2  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "sijaintiluvut.html#moodi",
    "href": "sijaintiluvut.html#moodi",
    "title": "3  Sijaintiluvut",
    "section": "3.1 Moodi",
    "text": "3.1 Moodi\nMittausasteikot: Kaikki\nMoodi on jakauman tyypillisin arvo. Moodin voi saada laskemalla jokaisen arvon esiintymisen, jolloin eniten esiintyvä arvo on jakauman moodi.\nJakauma voi olla unimodaalinen (yksi moodi), bimodaalinen (kaksi moodia) tai multimodaalinen (kolme moodia). Alla olevat kuvat näyttävät nämä modaalisuudet.\nNormaalijakaumassa moodi, keskiarvo ja mediaani ovat kaikki samoja. Positiivisen ja negatiivisen vinouman normaalijakaumissa moodi pysyy samana, mutta keskiarvo ja mediaani muuttuvat. Kurtoosi ei vaikuta normaalijakauman moodiin.\nUniformijakaumassa kaikki datapisteet ovat jakauman moodeja, koska jokainen esiintyy yhtä useasti.\nMoodi kirjoitetaan useimmiten merkeillä \\(\\text{Mo}\\)."
  },
  {
    "objectID": "sijaintiluvut.html#mediaani",
    "href": "sijaintiluvut.html#mediaani",
    "title": "3  Sijaintiluvut",
    "section": "3.2 Mediaani",
    "text": "3.2 Mediaani\nMittausasteikot: Järjestys-, välimatka- ja suhdeasteikko\nMediaani on jakauman keskipistearvo. Mediaanin voi saada järjestämällä kaikki arvot pienimmästä suurimpaan, ja jakamalla janan kahteen tasakokoiseen osaan. Jos jakaumaan kuuluu pariton määrä arvoja, mediaani on janan keskipiste. Jos jakaumaan kuuluu parillinen määrä arvoja, mediaani on kahden keskeisimmän arvon keskiarvo, \\(\\frac{a+b}{2}\\).\nJakaumassa voi aina olla vain yksi mediaani.\nNormaalijakaumassa moodi, keskiarvo ja mediaani ovat kaikki samoja. Mediaaniin vaikuttaa vinouma, joskin ei yhtä paljon kuin keskiarvoon. Kurtoosi ei vaikuta normaalijakauman mediaaniin.\nMediaani kirjoitetaan useimmiten merkeillä \\(\\text{Md}\\) tai \\(\\text{M}\\)."
  },
  {
    "objectID": "sijaintiluvut.html#fraktiilit",
    "href": "sijaintiluvut.html#fraktiilit",
    "title": "3  Sijaintiluvut",
    "section": "3.3 Fraktiilit",
    "text": "3.3 Fraktiilit\nMittausasteikot: Järjestys-, välimatka- ja suhdeasteikko\nFraktiilit (sanasta fraction; vaihtoehtoisesti kvantiilit, sanasta quantity) ovat yleistyksiä mediaanista. Fraktiileja löytyy useampia, joista yleisimmät ovat kvartiilit (neljäsosat), kvintiilit (viidesosat), desiilit (kymmenesosat) ja persentiilit (sadasosat).\nFraktiilin voi saada järjestämällä kaikki arvot pienimmästä suurimpaan, ja jakamalla jana tiettyyn määrään samankokoisiin osiin. Fraktiilin nimi kertoo, kuinka monta osaa: kvartiilit edustavat neljää osaa, kvintiilit viittä osaa, desiilit kymmentä osaa ja persintiilit sataa osaa.\nFraktiilit ilmaistaan numerosarjana jossa on \\(k-1\\) numeroa. Kvartiileille ilmaistaan siis kolme arvoa (ensimmäinen, toinen ja kolmas kvartiili), desiileille yhdeksän arvoa, ja persentiileille 99 arvoa. Käytännössä yleensä ilmaistaan vain ne, joista ollaan kiinnostuneita, varsinkin persentiilien kohdalla.\nKvartiileille toinen kvartiili on sama kuin mediaani. Jos ensimmäinen kvartiili on pienimmät 25 % jakaumasta, ja toinen kvartiili on seuraavat 25 %, niin yhteensä ne edustavat 50 % jakaumasta, samoin kuin mediaani.\nFraktiili voi olla inklusiivisia tai ekslusiivisia. Inklusiivinen fraktiili sisältää raja-arvon, ekslusiivinen fraktiili ei sisällä raja-arvoa. Joka tapauksessa fraktiilin arvo edustaa arvoa, jonka alle jää X määrä jakaumasta.\nEsimerkkinä septiilit, eli seitsemännesosat. Ensimmäinen septiili (inklusiivinen) edustaa prosenttiosuuksia 0-7 %, toinen septiili prosenttiosuuksia 8-14 %, jne., ja kuudes septiili osuuksia 94-100 %. Tällöin toisen septiilin alle jää 14 % kaikesta datasta ja ylle jää \\(100-14 = 86\\%\\). Yleistäen voi siis sanoa, että N:n septiilin alle jää aina \\((7*N)\\%\\) ja ylle jää \\(100-(7*N)\\%\\).\nKvartiilit kirjoitetaan useimmiten muotoon \\(Q_n\\), jossa \\(n\\) on kvartiilin järjestysnumero. Ensimmäinen kvartiili on \\(Q_1\\), toinen kvartiili (mediaani) on \\(Q_2\\), ja kolmas kvartiili on \\(Q_3\\). Muille fraktiileille ei löydy yleistä kirjoitusmuotoa."
  },
  {
    "objectID": "sijaintiluvut.html#keskiarvo",
    "href": "sijaintiluvut.html#keskiarvo",
    "title": "3  Sijaintiluvut",
    "section": "3.4 Keskiarvo",
    "text": "3.4 Keskiarvo\nMittausasteikot: Välimatka- ja suhdeasteikko\n(Aritmeettinen) Keskiarvo on jakauman painoitettu keskipiste, jossa painona käytetään jokaisen datapisteen esiintymistä. Keskiarvo lasketaan summaamalla kaikki datapisteet yhteen ja jakamalla tulos datapisteiden määrällä, \\(N\\)1:\n\\[\\bar{x} = \\frac{x_1 + x_2 + x_3 + ... + x_k}{N} = \\frac{1}{N}(\\sum_{i = 1}^{k}x_i)\\]\nKeskiarvo ei ole robusti sijaintimitta. Se vaikuttuu suuresti ääripääarvoista. Normaalijakaumassa mediaani, keskiarvo ja moodi ovat kaikki samoja. Vinouman myötä keskiarvo siirtyy vinouman suuntaan (oikealle positiivisessa ja vasemmalle negatiivisessa vinoumassa). Kurtoosi ei vaikuta keskiarvoon.\nKeskiarvo on kuitenkin erittäin oleellinen useimmissa tilastollisissa malleissa. Keskiarvoa käytetään niin sanottuna nollamallina, eli datajakaumaa “huonoiten” kuvaavana mallina. Useimmiten hypoteeseilla testataan siksi, eroaako jokin malli keskiarvon selitekyvystä. Jos ei, malli ei ole keskiarvoa parempi (eli on huono).\nVakaampana keskiarvomittarina voidaan käyttää rajattua keskiarvoa (engl. trimmed mean). Tällöin poistetaan ensin tietty prosenttiosuus jakauman ääripäistä, ja lasketaan sitten keskiarvo jäljelle jäävälle datalle. Yleinen prosenttiraja on 95 %, eli poistetaan 5 % (kaksi ja puoli prosenttia molemmista päistä) ja lasketaan keskiarvo jäljelle jäävälle osuudelle. Jos rajattu keskiarvo on hyvin samanlainen kuin keskiarvo, ääripääarvot eivät vaikuta suuresti keskiarvoon.2"
  },
  {
    "objectID": "sijaintiluvut.html#moodin-mediaanin-ja-keskiarvon-yhteys",
    "href": "sijaintiluvut.html#moodin-mediaanin-ja-keskiarvon-yhteys",
    "title": "3  Sijaintiluvut",
    "section": "3.5 Moodin, mediaanin ja keskiarvon yhteys",
    "text": "3.5 Moodin, mediaanin ja keskiarvon yhteys"
  },
  {
    "objectID": "sijaintiluvut.html#footnotes",
    "href": "sijaintiluvut.html#footnotes",
    "title": "3  Sijaintiluvut",
    "section": "",
    "text": "Jonkun arvon jakaminen \\(N\\):llä on sama kuin sen kertominen luvulla \\(1/N\\).↩︎\nTämä pätee vain keskiarvolle, ja vain yksinmuuttujakontekstissa. Monimuuttujakontekstissa ääripääarvot voivat olla ongelmallisia vaikka eivät vaikuttaisi yksittäisen muuttujan keskiarvoon. Rajatun ja tavallisen keskiarvon samankokoisuus ei siis takaa luotettavia analyyseja itsessään!↩︎"
  },
  {
    "objectID": "perustoiminnot.html#tietofunktiot",
    "href": "perustoiminnot.html#tietofunktiot",
    "title": "4  Funktiot",
    "section": "4.1 Tietofunktiot",
    "text": "4.1 Tietofunktiot\n\n4.1.1 ON-toiminnot\n=FUNKTIO(soluarvo)\nON-toiminnot palauttavat totuusarvon TOSI, jos niiden vaatimus solulle täyttyy. Jos vaatimus ei täyty, toiminnot palauttavat totuusarvon EPÄTOSI.\nSoluarvo voi olla arvo itsessään tai viittaus toiseen soluun.\nToiminnot ja niiden vaatimukset:\n\nONTYHJÄ: Onko soluarvo tyhjä?\nONVIRH: Onko soluarvo jotain muuta, kuin #PUUTTUU!? (Eli ONPUUTTUU-toiminnon vastakohta)\nONVIRHE: Onko soluarvo jokin virhearvo? (#PUUTTUU!, #ARVO!, #VIITTAUS!, #JAKO/0!, #LUKU!, #NIMI?, #TYHJÄ!)\nONTOTUUS: Onko soluarvo totuusarvo? (TOSI tai EPÄTOSI)\nONPUUTTUU: Onko soluarvo virhearvo #PUUTTUU!? (Eli ONVIRH-toiminnon vastakohta)\nONEI_TEKSTI: Onko soluarvo jotain muuta kun tekstiä? Palauttaa TOSI, jos soluarvo on tyhjä solu.\nONLUKU: Onko soluarvo luku?\nONVIITT: Onko soluarvo viittaus toiseen paikkaan?\nONTEKSTI: Onko soluarvo tekstiä?\nONPARILLINEN: Onko soluarvo parillinen? (Eli ONPARITON-toiminnon vastakohta)\nONPARITON: Onko soluarvo pariton? (Eli ONPARILLINEN-toiminnon vastakohta)\nONKAAVA: Onko soluarvo kaava?\n\n\n\n4.1.2 PUUTTUU\n=PUUTTUU()\nPalauttaa virhearvon #PUUTTUU!.\n\n\n4.1.3 SOLU\n=SOLU(kuvaus_laji; viittaus)\nPalauttaa tietoa soluviittauksesta.\nViittausalue määritellään viittaus-kohdassa. Tietopyyntö määritellään kuvaus_laji-kohdassa.\nTietopyyntöjen eri määritelmät:\n\nSOLU-funktion kuvaus_laji-avainsanat\n\n\nAvainsana\nPalautus\n\n\n\n\n“osoite”\nSoluviittauksen osoite tekstinä (esim. A2)\n\n\n“sarake”\nSolun sarake numerona (esim. 2 sarakkeelle B)\n\n\n“väri”\nArvo 1, jos solun negatiiviset arvot näkyvät värillisinä. Muuten arvo 0.\n\n\n“sisältö”\nSolun arvon (esim. 1000 tai “Hei”)\n\n\n“tiedostonimi”\nSolun sisältävän tiedoston nimen. Palauttaa tyhjää “” jos tiedostoa ei ole tallennettu.\n\n\n“muoto”\nSolun lukumuotoilun erityisenä merkkijonona. Katso kaikki merkkijonot funktion apusivuilta\n\n\n“sulkeet”\nArvo 1, jos solun positiiviset/kaikki arvot esitetään sulkeissa. Muuten arvo 0.\n\n\n“etuliite”\nSolun tasausmuotoilun erityisenä merkkijonona. Katso kaikki merkkijonot funktion apusivuilta\n\n\n“suojaus”\nArvo 1, jos solu on lukittu, tai arvo 0, jos solua ei ole lukittu.\n\n\n“rivi”\nSolun rivi numerona (esim. 2 riville 2)\n\n\n“tyyppi”\nSolun sisällön tyyppi erityisenä merkkijonona. Palauttaa “h” jos solu on tyhjä, “o” jos solussa on tekstivakio, ja muuten “r”.\n\n\n“leveys”\nPalauttaa kaksikohteisen matriisin. Ensimmäisessä kohteessa on solun sarakeleveys. Toisessa kohteessa on totuusarvo TOSI, jos kyseinen leveys on oletusarvo, ja EPÄTOSI jos leveyttä on muutettu käyttäjän toimesta."
  },
  {
    "objectID": "perustoiminnot.html#loogiset-funktiot",
    "href": "perustoiminnot.html#loogiset-funktiot",
    "title": "4  Funktiot",
    "section": "4.2 Loogiset funktiot",
    "text": "4.2 Loogiset funktiot\n\n4.2.1 TOSI ja EPÄTOSI\n=TOSI(), =EPÄTOSI()\nPalauttavat totuusarvot TOSI tai EPÄTOSI, nimensä mukaan. Voit vaihtoehtoisesti käyttää sanoja TOSI tai EPÄTOSI funktioiden sijaan.\n\n\n4.2.2 JA\n=JA(arg1; arg2; ...)\nPalauttaa totuusarvon TOSI, jos kaikki funktion argumenttien arvot ovat TOSI. Palauttaa EPÄTOSI, jos vähintään yksi funktion argumenteista on EPÄTOSI.\nTAI-funktion vastakohta.\nArgumenttien tulee olla totuusarvoja tai solu- tai matriisiviittauksia totuusarvoihin.\nFunktio ei ota huomioon tekstiä, lukuja tai tyhjiä soluja.\nKäytetään usein yhdistelmässä muiden loogisten funktioiden kanssa.\n\n\n4.2.3 JOS-funktiot\n=JOS(arvioitava; jostosi; josepätosi)\nArvioi loogisen funktion argumentissa arvioitava. Käyttäjä määrittelee mitä palautetaan, jos arvioitava-funktion tulos on tosi (argumentti jostosi), sekä jos tulos on epätosi (argumentti josepätosi).\n=JOSVIRHE(arvioitava; josvirhe)\nArvioi loogisen funktion argumentissa arvioitava. Käyttäjä määrittelee mitä palautetaan, jos funktion tulos palauttaa virhearvon (argumentti josvirhe).\n=JOSPUUTTUU(arvioitava; jospuuttuu)\nArvioi loogisen funktion argumentissa arvioitava. Käyttäjä määrittelee mitä palautetaan, jos funktion tulos palauttaa virhearvon #PUUTTUU! (argumentti jospuuttuu).\n=JOS.JOUKKO(arvioitava1; jostosi1; arvioitava2; jostosi2; ...)\nArvioi yhden tai useamman (korkeintaan 127) loogisen funktion ja palauttaa sitä vastaavan totuusfunktion jostosiN, jos arvioitavaN-funktion tulos on tosi.\nJokaiselle arvioitavalle funktiolle tulee syöttää yksi TOSI-ehdon alla tuotettava arvo, eli argumentit syötetään pareissa. Yksi ehto arvioidaan kahdella argumentilla (arvioitava1, jostosi1); kaksi ehtoa arvioidaan neljällä argumentilla (arvioitava1, jostosi1, arvioitava2, jostosi2); ja niin edelleen.\n\n\n4.2.4 EI\n=EI(arvioitava)\nPalauttaa argumentin arvioitava totuustuloksen vastakohdan, eli EPÄTOSI jos argumentin tulos on TOSI tai toisinpäin.\n\n\n4.2.5 TAI ja EHDOTON.TAI\n=TAI(arg1; arg2; ...)\nPalauttaa totuusarvon TOSI, jos vähintään yksi funktion argumenteista ovat TOSI. Palauttaa EPÄTOSI, jos kaikki funktion argumenttien totuusarvot on EPÄTOSI.\nJA-funktion vastakohta.\nArgumenttien tulee olla totuusarvoja tai solu- tai matriisiviittauksia totuusarvoihin.\nFunktio ei ota huomioon tekstiä, lukuja tai tyhjiä soluja.\nKäytetään usein yhdistelmässä muiden loogisten funktioiden kanssa.\n=EHDOTON.TAI(arg1; arg2; ...)\nPalauttaa totuusarvon TOSI, jos vähintään yksi mutta ei kaikki funktion argumenteista ovat TOSI. Palauttaa EPÄTOSI, jos kaikki funktion argumenttien totuusarvot ovat joko TOSI tai EPÄTOSI.\nEhdoton versio TAI-funktiosta. Toimii samalla tavalla.\n\n\n4.2.6 LAMBDA\n=LAMBDA(par1; par2; ...; parN; laskutoimitus)\nLAMBDA-toiminnolla voit laatia omia funktioitasi. Voit määritellä enintään 253 parametria (vähintään nolla) joita funktioisi käyttää. Voit sitten määritellä mitä funktiosi tekee argumentilla laskutoimitus.\nToimivan LAMBDA-funktion toteuttamisen jälkeen voit rekisteröidä funktion nimen Nimien hallinta -tilassa, jolloin funktiota pystyy käyttämään koko työkirjassa (tai työlehtiössä, jos olet rajannut käytön. Ks. LUKU NIMIEN HALLINNASTA).\nLAMBDA-toiminto kannattaa tehdä kolmessa askeleessa:\n\nTestaa, että laskutoimitus-kaavasi toimii. Muista luoda sille tapoja reagoida virheisiin (käytä tietofunktioita!)\nTestaa, että koko LAMBDA-funktio toimii. Kirjoita se kokonaisuudessaan soluun, ja lisää loppuun testiarvot omaan sulkuun: =LAMBDA(x; y; x+y+1)(1;2) määrittelee funktion ja ajaa sen testiarvoilla x = 1 ja y = 2.\nLisää funktio Nimien hallinta-tilaan. Muista määritellä oikea käyttöalue (työkirja tai yksittäiset taulukot) sekä antaa kuvaileva nimi ja kommentti. Katso lisää nimien hallinnasta luvusta LUKU NIMIEN HALLINNASTA).\n\n\n\n4.2.7 BYCOL, BYROW ja MAP\n=BYCOL(matriisi; LAMBDA(sarake)), =BYROW(matriisi; LAMBDA(rivi)), =MAP(matriisi; LAMBDA(solu)\nFunktioilla voit suorittaa LAMBDA-funktion määritetyn matriisialueen jokaiselle riville (BYROW), sarakkeelle (BYCOL) tai yksittäiselle solulle (MAP).\nArgumentilla matriisi määrittelet data-alueen, jonka datalla haluat toimittaa LAMBDA-funktion.\nArgumentilla LAMBDA() määrittelet LAMBDA-funktion, mikä tulee ajaa haluamasi data-alueella.\nMäärittele LAMBDA-funktio niin kuin tekisit oman funktion, mutta älä rekisteröi sen nimeä - funktiota käytetään vain tässä kontekstissa.\nFunktiopari BYCOL ja BYROW palauttaa matriisiin kooltaan 1*N, jossa N on kuinka monta kertaa funktio ajettiin. Funktio MAP taas palauttaa matriisin, jonka koko vastaa alkuperäistä data-aluetta (koska funktion LAMBDA-funktio lasketaan jokaiselle solulle).\nJos määritelty data-alue sisältäisi neljä saraketta, BYCOL palauttaisi 1*4-matriisin. Jos määritelty data-alue taas sisältäisi kolme riviä, BYROW palauttaisi 1*3-matriisin. Jos määritelty data-alue sisältää neljä saraketta ja kolme riviä, MAP palauttaisi 4*3-matriisin.\nMAP-funktio osaa myös yhdistää monia solujonoja yhteen. Tällöin funktio palauttaa 1*N-matriisin, jossa N on yhdistettävien solujonojen määrä. Esimerkiksi =MAP(A1:A5; B1:B5; C1:C5; LAMBDA() palauttaa 1*3-matriisin, jossa jokainen solu on LAMBDA-funktion lopputulos kullekin solujonolle (ensin A1:A5, sitten B1:B5, ja viimeiseksi C1:C5).\nOle tarkkana kun syötät MAP-funktiolle dataa! Jos yhdistät solujonoja, funktiot ajetaan per solujono, mutta jos syötät kokonaisen matriisin, funktiot ajetaan per solu.\nEsimerkki:\n=BYCOL(A1:C2; LAMBDA(sarake; MAKS(sarake)) palauttaa 1*3-matriisin (koska data-alueella on kolme saraketta, A, B ja C). Jokaisessa solussa on LAMBDA-funktion lopputulos sille sarakkeelle (ensimmäisessä solussa tulos A-sarakkeelle, toisessa B-sarakkeelle ja kolmannessa C-sarakkeelle). Laskettava funktio on MAKS(sarake), mikä palauttaa sarakkeen suurimman arvon."
  },
  {
    "objectID": "perustoiminnot.html#haku--ja-viitefunktiot",
    "href": "perustoiminnot.html#haku--ja-viitefunktiot",
    "title": "4  Funktiot",
    "section": "4.3 Haku- ja viitefunktiot",
    "text": "4.3 Haku- ja viitefunktiot\n\n4.3.1 VALITSE-funktiot\n=VALITSESARAKKEET(matriisi; sarake1; ...), =VALITSERIVIT(matriisi; rivi1; ...)\nFunktio palauttaa valitut sarakkeet tai rivit matriisi-alueelta. Funktiolle annetaan sarake- tai rivinumero (ei siis kirjainta sarakkeiden kohdalla!), sekä alue, josta haetaan. Funktioille voi antaa useamman sarake- tai rivinumeron.\nNegatiivisilla rivi- tai sarakenumeroilla voi hakea tietoja matriisin lopusta. Arvo -1 on sama kuin viimeinen sarake/rivi, -2 toiseksi viimeinen, ja niin eteenpäin. Näin funktio voi toimia, vaikka et tietäisi, kuinka monta riviä/saraketta alkuperäisessä matriisissa olisi.\nRivi- tai sarakenumerot eivät tarvitse olla alkuperäisessä järjestyksessään, vaan ne palautetaan siinä järjestyksessä, miten ne määritellään funktiossa. Esimerkiksi sarakenumerot 1, 2, 5, 4 palauttaa vastaavat sarakkeet (A, B, E, D) tässä järjestyksessä.\nEsimerkki:\n=VALITSESARAKKEET(A1:C5; 2) palauttaa sarakkeen B (sarakenumero 2) kaikki arvot. Koska alueella on viisi riviä, funktio palauttaa seuraavat solut: B1, B2, B3, B4, B5.\n=VALITSERIVIT(A1:C5, 2, 4) palauttaa rivien 2 ja 4 kaikki arvot. Koska alueella on kolme saraketta ja valittiin kaksi riviä palautukseen, funktio palauttaa matriisin jossa ensimmäisellä rivillä on solut A2, B2, C2 ja toisella rivillä solut A4, B4, C4.\n\n\n4.3.2 SARAKE ja RIVI\n=SARAKE(solu), =RIVI(solu)\nFunktiot palauttavat solun sarake- tai rivinumeron. Numerointi on juoksevassa järjestyksessä: riveillä numero on sama kuin rivin viittausnumero yleisesti (1 on 1, 2 on 2, jne.), ja sarakkeille numerointi alkaa yhdestä (A on 1, B on 2, jne.).\n\n\n4.3.3 HYLKÄÄ\n=HYLKÄÄ(matriisi; rivit; sarakkeet)\nFunktio poistaa määritetyn määrän rivejä ja/tai sarakkeita alkuperäisestä matriisista, ja palauttaa tämän uuden matriisin. Poisto koskee vain palautettua matriisia - funktio ei siis poista tietoja alkuperäisestä matriisista. rivit on pakollinen, sarakkeet on valinnainen.\nNegatiivisilla arvoilla voit poista rivejä/sarakkeita matriisin lopusta alkupään sijaan: rivit = -1 poistaa viimeisen rivin, sarakkeet = -3 poistaa kolme viimeistä saraketta, ja niin eteenpäin.\n\n\n4.3.4 SUODATA\n=SUODATA(matriisi; sisällytä; jostyhjä)\nFunktio palauttaa suodatetun version alkuperäisestä matriisista. Avainsanalla sisällytä määrittelet hakualueen, jonka pohjalta suodatetaan, sekä loogisen säännön millä sisällytetään rivejä. Avainsanalla jostyhjä määrittelet mitä palautetaan, jos palautettava matriisi on tyhjä (eli suodatin ei löytänyt yhtään sääntöä vastaavaa tulosta).\nEsimerkki:\n=SUODATA(A1:C5; B1:B5 = 2) hakee matriisin A1:C5 (kolme saraketta, viisi riviä), ja palauttaa kaikki rivit, joiden B-sarakkeen arvo on 2. Jos näitä ei ole, funktio palauttaa virhearvon #TYHJÄ!.\n=SUODATA(A1:C5; var1 = E1; \"Ei löydy!\") hakee matriisin A1:C5 (kolme saraketta, viisi riviä), ja palauttaa kaikki rivit, joiden nimetystä sarakkeesta “var1” löytyy arvo, joka itsessään on määritelty solussa E1. Jos solussa E1 lukee esimerkiksi 2, funktio palauttaa säännön var1 = 2 mukaan; jos siinä lukee “b”, funktio palauttaa säännön var1 = \"b\" mukaan, ja niin eteenpäin. Jos palautettavia arvoja ei ole ollenkaan, funktio palauttaa tekstijonon “Ei löydy!”. HUOM: Jos nimeä “var1” ei olla määritelty, funktio palauttaa virheen (luultavasti #NIMI!, koska nimi on väärin).\n\n\n4.3.5 XHAKU\n=XHAKU(hakuarvo; hakumatriisi; palautusmatriisi; joseilöydy; vastaavuustila; hakutila)\nFunktiolla suoritat hakuja alkuperäisestä matriisista ja palautat yhden tai useamman solun. Funktio on hyvin joustava siinä, mitä se palauttaa ja missä muodossa. Avainsanat ovat:\n\nhakuarvo (pakollinen): Mitä haetaan? Voi olla mikä tahansa Excelissä pätevä datamuoto (esim. luku, päivämäärä, merkkijono, jne.)\nhakumatriisi (pakollinen): Mistä haetaan? Määrittele joko rivi tai sarake kokonaisuudessaan. Esim. A1:A5 hakee sarakkeesta A, var1 hakee nimetyltä alueelta “var1”, A1:C1 hakee riviltä 1. Tämä on siis avainsana, jolla määrittelet, mitä loogista sääntöä yrität täyttää (“hae kaikki rivit, joiden sukupuoli on 2; hae kaikki rivit, joiden bruttotulo on 60 000 euroa”…)\npalautusmatriisi (pakollinen): Miltä alueelta palautetaan? Määrittele joko rivi tai sarake kokonaisuudessaan. Tämä avainsana määrittelee siis, mikä arvo palautetaan, kun olet löytänyt hakuarvon määritetystä hakumatriisista (“kun olet löytänyt kaikki rivit, joiden sukupuoli on 2, palauta niiden bruttovuositulot”).\njoseilöydy (valinnainen): Mitä palautetaan, jos mitään ei löydy? Jos ei määritellä tätä avainsanaa, funktio palauttaa virhearvon #PUUTTUU! jos palautettavaa ei löydy.\nvastaavuustila (valinnainen): Miten tarkasti haetaan? Oletusasetuksena funktio hakee tarkan vastaavuuden, ja palauttaa #PUUTTUU! jos sitä ei löydy. Voit myös määritellä yhden seuraavista: -1 palauttaa tarkan vastaavuuden tai seuraavaksi pienimmän kohteen, 1 palauttaa tarkan vastaavuuden tai seuraavaksi suuremman kohteen, 2 hakee laajalla vastaavuudella, jossa voit käyttää villikorttimerkkejä *, ?, ~.\nhakutila (valinnainen): Miten ja missä järjestyksessä haku suoritetaan? Oletuksena haku suoritetaan ensimmäisestä kohteesta alkaen (1), voit myös määritellä sen suoritettavan viimeisestä kohteesta (-1), binaarihaku nousevassa järjestyksessä (2) tai binaarihaku laskevassa järjestyksessä (-2). Binaarihaut ovat nopeampia, mutta vaativat, että matriisi on valmiiksi järjestetty kyseiseen järjestykseen - muutoin ne palauttavat virheellisiä tuloksia.\n\n[TÄHÄN PAREMPI SELITYS XHAUN TOIMINNASTA.]\n\n\n4.3.6 Lajittelufunktiot\n=LAJITTELE(matriisi; lajitteluindeksi; lajittelujärjestys; sarmukaan), =LAJITTELE.ARVOJEN.PERUSTEELLA(matriisi; mukaan1; järjestys1; mukaan2; järjestys2; ...)\nFunktiot hakevat alkuperäisen matriisin, lajittelevat sen tietyn säännön mukaan, ja palauttavat lajiteltun matriisin.\nLAJITTELE-funktiossa määrittelet ensin mikä matriisi-alue lajitellaan. Jos valitset useamman rivin/sarakkeen, voit myös määritellä, minkä rivin/sarakkeen mukaan lajitellaan avainsanalla lajitteluindeksi. Avainsana lajittelujärjestys määrittelee, onko lajittelu nousevassa (1, oletus) vai laskevassa (-1) järjestyksessä. Avainsanalla sarmukaan voit määritellä, lajitellaanko rivin (EPÄTOSI, oletus) vai sarakkeen (TOSI) mukaan.\nLAJITTELE.ARVOJEN.PERUSTEELLA-funktio tekee melkein saman, mutta sillä voit määritellä useamman lajittelualueen ja -järjestyksen. Funktio lajittelee ensin alueen mukaan1 mukaan, järjestyksessä järjestys1 (samat arvot ja oletukset kuin lajittelujärjestys yllä), sitten alueen mukaan2 ja järjestyksen järjestys2 mukaan, ja niin eteenpäin.\nYhdistelemällä LAJITTELE- ja SUODATA-funktioita voit rakentaa joustavia ja (suht) nopeasti käytettävissä olevia ehdollisia hakuja tiedossasi. Haluatko kaikki vastaajat, joiden bruttotulot ovat vähintään 50 000 euroa, järjestettynä koulutustason mukaan? Onnistuu: =LAJITTELE.ARVOJEN.PERUSTEELLA(SUODATA(datamatriisi; bruttotulot &gt;= 50000); koulutustaso).\n\n\n4.3.7 OTA\n=OTA(matriisi; rivit; sarakkeet)\nFunktio palauttaa matriisista määritetyn määrän rivejä (pakollinen) ja sarakkeita (valinnainen). Rivit ja sarakkeet määritetään määrässä (esim. 2 tai 5 riviä). Negatiiviset numerot hakevat matriisin lopusta.\n\n\n4.3.8 TRANSPONOI\n=TRANSPONOI(matriisi)\nFunktio kääntää alkuperäisen matriisin siten, että riveistä tulee sarakkeita ja sarakkeista rivejä.\nAlueen, johon funktio palauttaa käännetyn matriisin, voi määritellä joko dynaamisesti (lisäämällä funktio vasempaan yläkulmaan ja painamalla Enter) tai eksplisiittisesti (maalaamalla ensin koko alue, ja kirjoittamalla funktio suoraan alueeseen. Lopussa painetaan Ctrl + Shift + Enter, jotta funktio täyttää koko alueen eksplisiittisesti eikä dynaamisesti).\n\n\n4.3.9 AINUTKERTAISET.ARVOT\n=AINUTKERTAISET.ARVOT(matriisi; sarmukaan; vainkerran)\nFunktio palauttaa matriisin kaikki uniikit (ainutkertaiset) arvot. Valinnaisella loogisella avainsanalla sarmukaan funktio palauttaa uniikit sarakkeet (TOSI) rivien sijaan (EPÄTOSI tai jätetty pois). Valinnaisella loogisella avainsanalla vainkerran voit määritellä, että funktio palauttaa vain ne uniikit arvot, jotka esiintyvät vain yhden kerran matriisissa (useamman kerran sijaan)."
  },
  {
    "objectID": "perustoiminnot.html#matemaattiset-ja-trigonometriset-funktiot",
    "href": "perustoiminnot.html#matemaattiset-ja-trigonometriset-funktiot",
    "title": "4  Funktiot",
    "section": "4.4 Matemaattiset ja trigonometriset funktiot",
    "text": "4.4 Matemaattiset ja trigonometriset funktiot\nKoska matemaattisia ja trigonometrisia funktioita löytyy hyvin suuri määrä Excelissä, avaan tässä luvussa vain yleisimmät, tilastotieteen käytössä olevat funktiot. Tarkista koko luettelo Excelin opassivuilla.\n\n4.4.1 Trigonometriset funktiot\nTrigonometrisia funktioita on suuri määrä Excelissä. Jokaiselle funktiolle annetaan alkuperäinen arvo avainsanana (=FUNKTIO(arvo)). Excelissä löytyy yleisimmät identiteettifunktiot sekä niiden hyperboliset versiot (aina jälkiliitteellä H funktion nimessä). Katso Excelin opassivut (linkitetty tämän sivun alussa) kaikista funktioista.\n\n\n4.4.2 ITSEISARVO\n=ITSEISARVO(arvo)\nPalauttaa arvon itseisarvon, eli absoluuttisen arvon.\n\n\n4.4.3 KOOSTE ja VÄLISUMMA\n=KOOSTE(funktio; asetukset; matriisi; k)\n=VÄLISUMMA(funktio; viittaus)\nKOOSTE-funktio palauttaa yleisiä koostefunktioita määrätylle matriisiviittaukselle. Funktio toimii siten niin sanottuna wrapper-funktiona, eli sille syötetään, mikä funktio halutaan ajaa matriisilla.\nVÄLISUMMA-funktio tekee saman, mutta on yksinkertaisempi. Funktio ei ota asetuksia.\nPakollisella avainsanalla funktio määrittelet, minkä luvun haluat laskea. Vaihtoehtoja on yhteensä 19, numeroituna 1-19:\n\nKESKIARVO\nLASKE\nLASKE.A\nMAKS\nMIN\nTULO\nKESKIHAJONTA.S\nKESKIHAJONTA.P\nSUMMA\nVAR.S\nVAR.P\nMEDIAANI\nMOODI.YKSI\nSUURI\nPIENI\nPROSENTTIPISTE.SIS\nNELJÄNNES.SIS\nPROSENTTIPISTE.ULK\nNELJÄNNES.ULK\n\nKlikkaa nimiä hypätäksesi jokaisen funktion määritelmälle tällä sivulla. Tämä luettelo näkyy myös, kun kirjoitat funktiota Excelissä, joten sinun ei tarvitse osata sitä ulkoa.\nVÄLISUMMA-funktiossa voit käyttää vain ensimmäistä yhtätoista funktiota (eli KESKIARVOsta VAR.P:hen).\nPakollisella avainsanalla asetukset määrittelet, mitkä eri arvot ohitetaan laskussa. Jos funktio löytää näitä arvoja matriisin sisällä, se seuraa tässä määriteltyä logiikkaa. Asetuksia on kahdeksan:\n\nOhittaa VÄLISUMMA- ja KOOSTE-funktiot.\nOhittaa piiloitetut rivit, VÄLISUMMA- ja KOOSTE-funktiot.\nOhittaa virhearvot, VÄLISUMMA- ja KOOSTE-funktiot.\nOhittaa piiloitetut rivit, virhearvot, VÄLISUMMA- ja KOOSTE-funktiot.\nEi ohita mitään.\nOhittaa piiloitetut rivit.\nOhittaa virhearvot.\nOhittaa piiloitetut rivit ja virhearvot.\n\nHUOM: Funktio ei ohita asioita, jos funktion sisällä tehdään laskutoimitus! Tällöin ohitus pitää tehdä laskutoimituksen sisällä, esim. käyttäen JOS- ja ONVIRH-rakenteita.\nVÄLISUMMA-funktio ei ota asetuksia, mutta muokkaamalla funktionumeroa voit ohittaa piiloitetut rivit. Funktiot 1-9 määritellään ohittamaan piiloitetut rivit lisäämällä 10 niiden etuliitteeksi: 101, 102, 103, jne. Funktiot 10 ja 11 ottavat numeron 1 etuliitteeksi: 110 on VAR ja 111 on VAR.P.\nPakollisella avainsanalla matriisi määrittelet alueen, jolle haluat laskea kyseisen laskufunktion.\nViimeinen avainsana, k, on pakollinen tietyillä laskufunktioilla. Funktioilla SUURI ja PIENI määrittelet, minkä k:n suurimman/pienimmän arvon haluat. PROSENTTIPISTE-funktioilla k määrittelee, minkä k:nnen prosenttipisteen arvon haluat. NELJÄNNES-funktoilla k määrittelee, minkä neljänneksen haluat.\n\n\n4.4.4 PARILLINEN ja PARITON\n=PARILLINEN(arvo), =PARITON(arvo)\nFunktiot pyöristävät luvun ylöspäin lähimpään parilliseen tai parittomaan kokonaislukuun.\n\n\n4.4.5 EKSPONENTTI\n=EKSPONENTTI(arvo)\nPalauttaa arvon \\(e^\\text{arvo}\\).\n\n\n4.4.6 KERTOMA\n=KERTOMA(arvo)\nPalauttaa arvon kertoman, eli faktoriaalin. Luvun faktoriaali on yhtä kuin sarja\n\\[\\prod_{i=1}^{n}{i}\\]\nJos luku on 5, niin KERTOMA(5) palauttaa \\(5*4*3*2*1=120\\).\n\n\n4.4.7 Pyöristysfunktiot\n=PYÖRISTÄ.KERR(arvo; tarkkuus)\n=PYÖRISTÄ.KERR.ALAS(arvo; tarkkuus)\n=PYÖRISTÄ.KERR.YLÖS(arvo; tarkkuus)\n=PYÖRISTÄ.KERR.ALAS.TARKKA(arvo; tarkkuus)\n=PYÖRISTÄ(arvo; desimaalit)\n=PYÖRISTÄ.DES.ALAS(arvo; desimaalit)\n=PYÖRISTÄ.DES.YLÖS(arvo; desimaalit)\nKaikki pyöristysfunktiot toimivat kutakuinkin samalla tavalla ja näyttävät samoilta, mutta pienillä vivahde-eroilla.\nTavallinen pyöristys hoituu funktiolla PYÖRISTÄ, joka ottaa arvon joka pyöristetään, sekä desimaalitarkkuuden numeroissa. Esim. =PYÖRISTÄ(2,673; 1) pyöristää arvon yhden desimaalin tarkkuudelle, eli 2.7. Suunta määräytyy niin kuin matematiikassa yleensä, eli &gt;= 0.5 pyöristetään ylös ja &lt; 0.5 alas.\nJos haluat pyöristää tiettyyn suuntaan, voit käyttää PYÖRISTÄ.DES.ALAS tai PYÖRISTÄ.DES.YLÖS.\nFunktioperhe PYÖRISTÄ.KERR pyöristää tiettyä kerrannaisnumeroa kohtaan. Funktio hakee siis lähimmän numeron, jonka voi tasajakaa tarkkuus-arvolla. Pääteliitteet .ALAS ja .YLÖS määrittelevät pyöristyksen suunnan. Yleisfunktiossa PYÖRISTÄ.KERR suunta määräytyy jakojäännöksen perusteella: jos jaosta jää &gt;= puolet kerrannaisen arvosta, se pyöristää ylöspäin, ja muuten alaspäin. Esimerkkinä =PYÖRISTÄ.KERR(10;3) laskee, että kymmenen jaon kolmella jättää yhden jäljelle, mikä on vähemmän kuin puolet kolmesta (&lt;= 1.5), joten se pyöristää alaspäin. Lähin tasajakonumero alaspäin on 9, joten tulos on 9.\n\n\n4.4.8 SUURIN.YHT.TEKIJÄ ja PIENIN.YHT.JAETTAVA\n=SUURIN.YHT.TEKIJÄ(luku1; luku2; ...), =PIENIN.YHT.JAETTAVA(luku1; luku2; ...)\nFunktiot hakevat suurimman tai pienimmän yhteisen tekijän kahdelle tai useammalle arvolle. Nolla on tässä jaettava kaikilla luonnollisilla luvuilla, ja negatiiviset luvut eivät toimi.\n\n\n4.4.9 Logaritmit\n=LOG(arvo; kanta), =LOG10(arvo), =LUONNLOG(arvo)\nFunktioperhe LOG palauttaa arvon logaritmin. Erikoisfunktiot LOG10 ja LUONNLOG palauttavat arvon kymmenkantaisen logaritmin \\(10^{x}\\) ja luonnollisen logaritmin \\(e^{x}\\). Muut logaritmikannat määritellään LOG-funktion kanta-avainsanalla.\n\n\n4.4.10 JAKOJ\n=JAKOJ(luku; jakaja)\nFunktio palauttaa jäännöksen jakolaskulle luku/jakaja. Jakojäännöksellä on aina sama etumerkki (positiivinen tai negatiivinen) kuin jakajalla.\n\n\n4.4.11 PII\n=PII()\nPalauttaa piin arvon 15:lla desimaalilla.\n\n\n4.4.12 Satunnaisluvut\n=SATUNNAISLUKU(), =SATUNNAISLUKU.VÄLILTÄ(alku; loppu)\nFunktiot generoivat satunnaislukuja. Perusfunktio SATUNNAISLUKU tuottaa yhden luvun väliltä 0-1, ja funktio SATUNNAISLUKU.VÄLILTÄ tuottaa luvun väliltä alku-loppu. Luvut generoidaan Mersenne Twister -algoritmilla, ja tuotetaan uudelleen joka kerta, kun kaavat lasketaan uudelleen.\n\n\n4.4.13 Neliöjuuret\n=NELIÖJUURI(arvo), =NELIÖJUURI.PII(arvo)\nFunktiot laskevat arvon neliöjuuren. Perusfunktio laskee tavallisen neliöjuuren (positiivisen), NELIÖJUURI.PII kertoo ensin arvon piillä ja laskee sitten neliöjuuren.\n\n\n4.4.14 Summat\n=SUMMA(alue)\n=SUMMA.JOS(alue; ehto)\n=SUMMA.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)\nSummafunktiolla lasket yhteen määrätyn alueen kaikki arvot. Voit asettaa ehdon summaukselle käyttämällä SUMMA.JOS-funktiota, jolloin arvot summataan yhteen vain silloin, kun ne täyttävät loogisen ehdon ehto-avainsanassa.\nJos haluat määritellä useita ehtoja, tai jos ehdot riippuvat jonkun toisen alueen arvoista, voit käyttää SUMMA.JOS.JOUKKO-komentoa. Jokainen ehto määritellään alue-ehto-parina, jossa ehtoalue määrittelee, millä alueella ehto tarkistetaan, ja ehto määrittelee itse ehdon. Alue-ehto-pareja voi olla 127 kappaletta.\n\n\n4.4.15 Neliösummat\n=NELIÖSUMMA(alue)\n=NELIÖSUMMIEN.EROTUS(alue1; alue2)\n=NELIÖSUMMIEN.SUMMA(alue1; alue2)\n=EROTUSTEN.NELIÖSUMMA(alue1; alue2)\nTämä funktioperhe laskee neliösummia, jolloin ensin otetaan jokaisen arvon neliö (\\(x^2\\)) ja sitten summataan ne yhteen. Perusfunktio NELIÖSUMMA tekee tämän arvosarjalle, esim. kokonaiselle sarakkeelle tai riville. Kaava tälle on: \\(\\sum{x^2}\\)\nKolme seuraavaa toimivat kahdella alueella, ja tekevät eri asioita riippuen funktiosta:\n\nNELIÖSUMMIEN.EROTUS laskee kahden alueen jokaisen arvon neliön, vähentää ne toisistaan (alue2 - alue1) ja summaa lopputuloksen yhteen. Kaava on: \\(\\sum{x^2-y^2}\\)\nNELIÖSUMMIEN.SUMMA laskee kahden alueen jokaisen arvon neliön ja summaa ne yhteen. Kaava on: \\(\\sum{x^2 + y^2}\\)\nEROTUSTEN.NELIÖSUMMA laskee ensin kahden alueen jokaisen arvon eron (alue2 - alue1), ottaa tuloksen neliön ja summaa kaikki nämä yhteen. Kaava on: \\(\\sum{(x-y)^2}\\)\n\n\n\n4.4.16 KATKAISE\n=KATKAISE(luku; numerot)\nFunktio pudottaa desimaalit annetulta luvulta. Oletusarvona funktio pudottaa kaikki desimaalit, mutta voit myös määritellä kuinka monta jätetään valinnaisella avainsanalla numerot. Huomaa, että funktio ei pyöristä, vaan tiputtaa vain pois desimaalit!"
  },
  {
    "objectID": "perustoiminnot.html#tilastolliset-funktiot",
    "href": "perustoiminnot.html#tilastolliset-funktiot",
    "title": "4  Funktiot",
    "section": "4.5 Tilastolliset funktiot",
    "text": "4.5 Tilastolliset funktiot\n\n4.5.1 Sijaintiluvut\n\n4.5.1.1 LASKE-funktiot\n=LASKE(alue)\n=LASKE.A(alue)\n=LASKE.TYHJÄT(alue)\n=LASKE.JOS(alue; ehto)\n=LASKE.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)\nJos haluat laskea, kuinka monta arvoa tietyllä alueella on (esim. laskeaksesi pätevän N:n tietylle laskutoiminnolle), voit käyttää funktiota LASKE. Funktio laskee vain luvut, päivämäärät ja tekstimuotoiset luvut joita se voi väkisin muuntaa luvuiksi.\nJos haluat laskea myös totuusarvoja, tekstiä tai virhearvoja, käytä funktiota LASKE.A. Funktio laskee kaikki arvot paitsi tyhjät solut.\nJos haluat laskea nimenomaan tyhjät solut, käytä funktiota LASKE.TYHJÄT. Funktio laskee tyhjät solut sekä solut, joissa on tyhjä teksti ““. Funktio ei laske nollaa!\nVoit ehdollistaa laskutoiminnon käyttämällä funktiota LASKE.JOS. Funktio laskee vain ne solut, jotka täyttävät ehdon. Huomaa, että funktio laskee samat arvot kuin perusfunktio LASKE, eli tyhjiä, tekstiä, totuusarvoja tai virheitä ei lasketa mukaan.\nVoit myös kirjoittaa useamman ehdon sekä käyttää eri ehtoalueita funktiolla LASKE.JOS.JOUKKO. Ehdot annetaan alue-ehto-pareina, jossa alue määrittelee, millä alueella ehdon on pädettävä alkuperäisen luvun ollakseen mukana laskussa, ja ehto määrittelee itse ehdon. Laskettava alue määritellään alue-avainsanalla, eli laskettava alue voi olla eri kuin ehtoalueet. Tyhjät solut kohdellaan arvona 0, sekä laskussa että ehdoissa.\n\n\n4.5.1.2 TAAJUUS\n=TAAJUUS(alue; lokerot)\nFunktio palauttaa frekvenssitaulukon. Määrittele ensin alue, josta haluat laskea kaikkien arvojen frekvenssit. Voit määritellä mitkä arvot lasketaan lokerot-alueella, mutta voit myös jättää sen pois, jolloin funktio automaattisesti laskee kaikki ainutlaatuiset arvot ja niiden esiintymiset.\nHuomaa, että lokerot tulee määritellä lukujanana! Voit joko kirjoittaa lokeroarvot vierekkäisiin soluihin jonnekin työlehteesi, tai kirjoittaa ne käsin funktioon käyttäen {}-syntaksia.\nJos määrittelet lokerot, voit laskea muuttujan tasoa suhde- tai välimatka-asteikolta järjestysasteikolle. Jokainen lokero jonka määrittelet on raja-arvo; ensimmäinen lokeroarvo on kaikki arvot alle tai yhtä suuria kuin lokeroarvo, toinen on kaikki arvot ensimmäisen ja toisen arvon välillä, jne. Jos siis määrittelet lokeroarvoina matriisialueen jossa on arvot {70, 79, 89}, niin funktio laskee neljä lokeroa: Arvot 70 tai vähemmän, arvot 71-79, arvot 80-89, ja arvot 90 tai enemmän.\n\n\n4.5.1.3 Moodi\n=MOODI.YKSI(alue), =MOODI.USEA(alue)\nFunktiot hakevat lukusarjan moodin, eli useimmiten esiintyvän arvon. Jos odotat vain yhtä moodia, käytä funktiota MOODI.YKSI, mutta huomaa, että sen käyttäytyminen jos se löytää useamman moodin ei ole määritelty! Multimodalisuuden kohdalla käytä funktiota MOODI.USEA, joka palauttaa pystysuuntaisen matriisin. Tämä matriisi sisältää kaikki esiintyvät moodit.\n\n\n4.5.1.4 MEDIAANI\n=MEDIAANI(alue)\nFunktio hakee lukusarjan mediaanin. Jos mediaaneja on kaksi (eli sarja on parillinen), funktio palauttaa kahden keskimmäisen arvon keskiarvon. Funktio laskee mukaan totuusarvot ja tekstimuotoiset luvut (“1”). Muut arvot antavat joko virheen tai ohitetaan, riippuen siitä, ovatko ne matriisiargumentissa vai suoraan viitattuna.\n\n\n4.5.1.5 Keskiarvo\n=KESKIARVO(alue)\n=KESKIARVO.JOS(alue; ehto; keskiarvoalue)\n=KESKIARVO.JOS.JOUKKO(keskiarvoalue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)\nYleisen aritmeettisen keskiarvon voit laskea funktiolla KESKIARVO.\nJos haluat ehdollistaa mitkä luvut valitaan keskiarvoon, voit käyttää funktiota KESKIARVO.JOS. Lisää ehto avainsanaan ehto. Ehto päteää alueeseen joka määriteltiin avainsanalla alue; jos haluat laskea keskiarvon jollekin muulle alueelle (esim. toiselle muuttujalle kuin ehtomuuttuja), määrittele se avainsanalla keskiarvoalue.\nJos haluat laskea keskiarvon käyttäen useampaa eri ehtoa, käytä funktiota KESKIARVO.JOS.JOUKKO. Ehdot syötetään aina alue-ehto-parina, jossa alue määrittelee miltä alueelta ehto tarkastetaan, ja ehto määrittelee itse ehdon.\n\n\n\n4.5.2 Hajontaluvut\n\n4.5.2.1 Pienin, suurin, ja raja-arvot\n=MIN(alue), =MAKS(alue)\n=MIN.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)\n=MAKS.JOS.JOUKKO(alue; ehtoalue1; ehto1; ehtoalue2; ehto2; ...)\n=PIENI(alue; k), =SUURI(alue; k)\n=PROSENTTIPISTE.SIS(alue; k), =PROSENTTIPISTE.ULK(alue; k)\n=NELJÄNNES.SIS(alue; neljännes), =NELJÄNNES.ULK(alue; neljännes)\nVoit hakea alueen pienimmän ja suurimman arvon funktioilla MIN (minimi) ja MAKS (maksimi).\nVoit myös ehdollistaa minimi- ja maksimihaun funktioilla MIN.JOS.JOUKKO ja MAKS.JOS.JOUKKO. Jokainen ehto määritellään alue-ehto-parina, jossa alue määrittelee, missä ehdon tulee pädetä, ja ehto määrittelee itse ehdon. Muista myös määritellä itse laskenta-alue avainsanalla alue!\nJos haluat hakea alueen k:nnen pienimmän tai suurimman arvon, käytä funktioita PIENI ja SUURI. Raja-arvo määritellään omalla avainsanallaan, k.\nJos haluat hakea tietyn fraktiilin persentiilinä, käytä funktioita PROSENTTIPISTE.SIS tai PROSENTTIPISTE.ULK. Molemmat funktiot ottavat alueen sekä arvon k, joka on persentiili ilmaistuna desimaalilukuna. Loppupääte SIS/ULK määrittelee kuuluuko raja-arvo itsessään fraktiilin sisälle (SIS) vai ei (ULK).\nNeljännekset, eli kvartiilit, voi hakea myös funktioilla =NELJÄNNES.SIS ja =NELJÄNNES.ULK. Kvartiilin numero ilmaistaan numeroina 0-4: Pienin arvo (0), ensimmäinen neljännes (1), toinen neljännes eli mediaani (2), kolmas neljännes (3), tai suurin arvo (4). Kvartiilinumerot 0, 2 ja 4 vastaavat tuloksia funktioista MIN, MEDIAANI ja MAKS vain jos käytät funktiota NELJÄNNES.SIS. Loppupääte määrittelee kuuluuko raja-arvo neljänneksen sisälle (SIS) vai ei (ULK).\n\n\n4.5.2.2 Kurtoosi ja vinouma\n=KURT(alue), =JAKAUMAN.VINOUS(alue)\nFunktiot laskevat alueen kurtoosin tai vinouman.\nExcelissä kurtoosi annetaan keskitettynä nollalle, jolloin positiivinen kurtoosi tarkoittaa terävää jakaumaa ja negatiivinen kurtoosi tarkoittaa leveää jakaumaa.\nPositiivinen vinouma tarkoittaa, että arvoja löytyy enemmän keskiarvon yllä, ja negatiivinen että arvoja löytyy keskiarvon alla.\n\n\n4.5.2.3 KESKIPOIKKEAMA\n=KESKIPOIKKEAMA(alue)\nFunktio laskee alueen keskipoikkeaman. Keskipoikkeama lasketaan kaavalla:\n\\[\\frac{\\sum{x-\\bar{x}}}{n}\\]\n\n\n4.5.2.4 Oikaistu neliösumma\n=OIKAISTU.NELIÖSUMMA(alue)\nFunktio laskee alueen oikaistun neliösumman (engl. deviance). Oikaistu neliösumma lasketaan kaavalla:\n\\[\\sum{(x-\\bar{x})^2}\\]\n\n\n4.5.2.5 Varianssi\n=VAR.S(alue)\nFunktio palauttaa alueen varianssin. Varianssi lasketaan kaavalla:\n\\[ s^2 = \\frac{\\sum{(x-\\bar{x})^2}} {n-1} \\]\nVarianssi on siten oikaistu neliösumma jaettuna datapisteiden määrällä minus yksi. Varianssi ilmaistaan alkuperäisen arvoasteikon neliönä (esim. neliöeuroa, neliöyksikköä).\n\n\n4.5.2.6 Keskihajonta\n=KESKIHAJONTA.S(alue)\nFunktio laskee alueen keskihajonnan (engl. standard deviation). Keskihajonta lasketaan kaavalla:\n\\[ \\sigma = \\sqrt{\\frac{\\sum{(x-\\bar{x})^2}} {n-1}} \\]\nKeskihajonta on siten varianssin neliöjuuri. Keskihajonta mitataan samalla asteikolla kuin alkuperäiset arvot.\n\n\n4.5.2.7 Z-arvo\n=NORMITA(x; keskiarvo; keskihajonta)\nPalauttaa arvon normitetun z-arvon. Funktiolle pitää antaa arvo, joka halutaan normittaa (x) sekä jakauman keskiarvo ja keskihajonta.\nZ-arvo lasketaan kaavalla:\n\\[ z = \\frac{x - \\bar{x}} {\\sigma} \\]\n\n\n\n4.5.3 Univariaatit testit\n\n4.5.3.1 Z-testi\n=Z.TESTI(alue; x; sigma)\nFunktio laskee z-testin yksisuuntaisen p-arvon.\nMäärittele testattava arvo avainsanalla x, ja alue, jota vastaan testaat avainsanalla alue. Testi testaa tuolloin, eroaako arvo x alueen keskiarvosta merkitsevästi. Toisin sanoin: kuinka suurella todennäköisyydellä saisit arvon x tai isomman, jos sen todellinen arvo onkin alueen keskiarvo eikä x.\nValinnaisella avainsanalla sigma voit antaa populaation tunnetun keskihajonnan. Jos jätät sen pois, keskihajonta estimoidaan otoksesta. Useimmiten sinun tulee jättää se pois.\nJos haluat laskea kaksisuuntaisen z-testin yksisuuntaisen sijaan (eli jos x:n ero keskiarvoon saa mennä kumpaan tahansa suuntaan), voit käyttää seuraavaa kaavaa:\n= 2 * MIN( Z.TESTI(); 1 - Z.TESTI() )\nFunktio ei laske testisuuretta! Jotta voit raportoida koko testin, sinun tulee myös laskea testisuure käsin. Voit käyttää NORMITA-funktiota laskeaksesi x-arvon z-normitetun arvon, jonka raportoit yhteydessä Z-testin palauttaman p-arvon kanssa.\n\n\n\n4.5.4 Bivariaatit testit\n\n4.5.4.1 KOVARIANSSI\n=KOVARIANSSI.S(matriisi1; matriisi2)\nFunktio laskee kahden matriisin yhteisen kovarianssin. Funktio olettaa, että matriisit ovat yhtä suuria otoksia kokonaispopulaatiosta. Funktio ohittaa tekstit, totuusasvot ja tyhjät solut, mutta ottaa huomioon nollan.\n\n\n4.5.4.2 Korrelaatiokertoin\n=PEARSON(matriisi1; matriisi2)\n=PEARSON.NELIÖ(matriisi1; matriisi2)\nFunktio PEARSON palauttaa kahden matriisin Pearsonin tulomomenttikorrelaatiokertoimen, r:n. Pearsonin korrelaatio lasketaan kaavalla:\n\\[ r = \\frac{\\sum{(x-\\bar{x})(y-\\bar{y})}} {\\sqrt{\\sum{(x-\\bar{x})^2}\\sum{(y-\\bar{y})^2}}} \\]\nFunktio PEARSON.NELIÖ laskee ensin r:n, ja palauttaa sitten sen neliön, \\(r^2\\). Voit tehdä saman ottamalla PEARSON-funktion tulokseen neliön.\n\n\n4.5.4.3 Khiin neliön testi\n\n\n4.5.4.4 T-testi\n=T.TESTI(matriisi1; matriisi2; suunta; laji)\nFunktio laskee t-testin p-arvon.\nEnsimmäiset kaksi avainsanaa määrittelevät kaksi matriisia, joita halutaan verrata toisiinsa. Avainsanalla suunta määrittelet, käytätkö yksisuuntaista (1) vai kaksisuuntaista (2) jakaumaa. Avainsanalla laji määrittelet t-testin lajin seuraavista:\n\nParittainen t-testi samasta otoksesta (ns. within-group)\nKahden otoksen t-testi, saman varianssin oletus (homoskedastinen; ns. between-groups)\nKahden otoksen t-testi, erisuuren varianssin oletus (heteroskedastinen; ns. between-groups)\n\nHuomaa, että laji 1 ei toimi, jos matriiseissa on eri määrät arvoja.\nFunktio ei laske testisuuretta! Joudut laskemaan testisuureen käsin. Kaavat riippuvat siitä, lasketko parittaisen (Yhtälö 4.1) vai kahden otoksen t-testin, sekä oletatko saman (Yhtälö 4.2) vai erisuuren (Yhtälö 4.3) varianssin.\nParittaisen t-testin kaava on:\n\\[\nt = \\frac{1/n\\sum{x-y}} {\\sigma/\\sqrt{N}}\n\\tag{4.1}\\]\n\\(1/n\\sum{x-y}\\) on erotuksen keskiarvo1, \\(\\sigma\\) on erotuksen keskihajonta, ja \\(\\sqrt{N}\\) on otoskoon neliöjuuri. Laske ensin muuttujien väliset erotukset uudeksi muuttujaksi. Laske sitten tämän muuttujan keskiarvo ja keskihajonta. Syötä viimeiseksi nämä, sekä otoskoon neliöjuuri, kaavaan. Lopputulos on parittaisen t-testin testisuure.\nKahden otoksen homoskedastisen t-testin kaava on:\n\\[\nt = \\frac{\\bar{x} - \\bar{y}} {\\sqrt{\\frac{\\sigma_1^2}{n_1} + \\frac{\\sigma_2^2}{n_2}}}\n\\tag{4.2}\\]\n\\(\\bar{x} - \\bar{y}\\) on molempien otosten keskiarvojen ero. \\(\\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}}\\) on erotuksen keskihajonta, joka koostuu useammasta asiasta. Voit kuitenkin laskea nämä helpommin Excelissä. Laske ensin molempien ryhmien keskiarvot ja niiden erotus. Laske sitten molempien ryhmien keskihajonnat, jaa ne ryhmien otoskoolla, ja summaa tulokset yhteen. Ota tämän tuloksen neliöjuuri. Viimeiseksi, jaa aikaisemmin laskettu keskiarvoerotus neliöjuuren tuloksella. Lopputulos on kahden otoksen homoskedastisen t-testin testisuure.\nKahden otoksen heteroskedastisen t-testin kaava on:\n\\[\n\\begin{split}\nt = \\frac{\\bar{x} - \\bar{y}} {\\sqrt{\\frac{s^2_p}{n_1} + \\frac{s^2_p}{n_2}}}\n\\\\\ns^2_p = \\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2} {n_1 + n_2 - 2}\n\\end{split}\n\\tag{4.3}\\]\nT-testin jaon yläpuoli on sama kuin homoskedastisessa testissä, mutta alaosa on muuttunut. Sen sijaan, että käytettäisiin erotusten keskihajontaa, käytetään niin sanottua ryhmitettyä varianssia (engl. pooled variance), \\(s^2_p\\). Se koostuu molempien otosten otoskoista \\(n_1\\) ja \\(n_2\\), sekä otosten yksittäisistä variansseista \\(s_1\\) ja \\(s_2\\).\nKoska nämä funktiot ovat pitkiä ja hankalia, olen tehnyt valmiit lambda-funktiot Exceliin, joita voitte käyttää. [LISÄÄ LAMBDA-FUNKTIOT!]"
  },
  {
    "objectID": "perustoiminnot.html#tekstifunktiot",
    "href": "perustoiminnot.html#tekstifunktiot",
    "title": "4  Funktiot",
    "section": "4.6 Tekstifunktiot",
    "text": "4.6 Tekstifunktiot"
  },
  {
    "objectID": "perustoiminnot.html#footnotes",
    "href": "perustoiminnot.html#footnotes",
    "title": "4  Funktiot",
    "section": "",
    "text": "Jonkun asian jakaminen n:llä on sama kuin sen kertominen 1/n:llä. Tämä osuus on vain yleinen keskiarvolaskelma, vaikka kirjoitettuna hieman eri muotoon.↩︎"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Viiteluettelo",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97."
  }
]